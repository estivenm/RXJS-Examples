!function(e,t){var n=r();function r(){return logger={pkg:e,state:e,capture:e,enable:e,updateConfigFromServer:e,trace:e,debug:e,log:e,info:e,warn:e,error:e,fatal:e},{init:e,enable:e,state:e,send:e,setUserContext:e,addEvent:e,enableAutoSend:e,_setClientId:e,logger:logger};function e(e){}}"function"==typeof define&&define.amd?(require.specified("ibmmfpfanalytics")||define("ibmmfpfanalytics",r),define(["ibmmfpfanalytics"],t)):(e.ibmmfpfanalytics||(e.ibmmfpfanalytics=n),e.WL=t(e.ibmmfpfanalytics))}(this,function(wlanalytics){function i(e){return"[object Array]"===Object.prototype.toString.call(e)}function j(e,t){if(i(e))for(var n=0;n<e.length;n++)t(e[n]);else t(e)}function k(e){var r="pending",o=[],s=[],a=[],u=null,n={done:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(i(arguments[e]))for(var t=arguments[e],n=0;n<t.length;n++)"resolved"===r&&t[n].apply(this,u),o.push(t[n]);else"resolved"===r&&arguments[e].apply(this,u),o.push(arguments[e]);return this},fail:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(i(arguments[e]))for(var t=arguments[e],n=0;n<t.length;n++)"rejected"===r&&t[n].apply(this,u),s.push(t[n]);else"rejected"===r&&arguments[e].apply(this,u),s.push(arguments[e]);return this},always:function(){return this.done.apply(this,arguments).fail.apply(this,arguments)},progress:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(i(arguments[e]))for(var t=arguments[e],n=0;n<t.length;n++)"pending"===r&&a.push(t[n]);else"pending"===r&&a.push(arguments[e]);return this},then:function(){1<arguments.length&&arguments[1]&&this.fail(arguments[1]),0<arguments.length&&arguments[0]&&this.done(arguments[0]),2<arguments.length&&arguments[2]&&this.progress(arguments[2])},promise:function(e){if(null==e)return n;for(var t in n)e[t]=n[t];return e},state:function(){return r},debug:function(){},isRejected:function(){return"rejected"===r},isResolved:function(){return"resolved"===r},pipe:function(e,t,n){return k(function(n){j(e,function(t){"function"==typeof t?l.done(function(){var e=t.apply(this,arguments);e&&"function"==typeof e?e.promise().then(n.resolve,n.reject,n.notify):n.resolve(e)}):l.done(n.resolve)}),j(t,function(t){"function"==typeof t?l.fail(function(){var e=t.apply(this,arguments);e&&"function"==typeof e?e.promise().then(n.resolve,n.reject,n.notify):n.reject(e)}):l.fail(n.reject)})}).promise()}},l={resolveWith:function(e){if("pending"===r){r="resolved";for(var t=u=1<arguments.length?arguments[1]:[],n=0;n<o.length;n++)o[n].apply(e,t)}return this},rejectWith:function(e){if("pending"===r){r="rejected";for(var t=u=1<arguments.length?arguments[1]:[],n=0;n<s.length;n++)s[n].apply(e,t)}return this},notifyWith:function(e){if("pending"===r)for(var t=u=1<arguments.length?arguments[1]:[],n=0;n<a.length;n++)a[n].apply(e,t);return this},resolve:function(){return this.resolveWith(this,arguments)},reject:function(){return this.rejectWith(this,arguments)},notify:function(){return this.notifyWith(this,arguments)}},t=n.promise(l);return e&&e.apply(t,[t]),t}var h;function printStackTrace(e){var t=(e=e||{guess:!0}).e||null,n=!!e.guess,r=new printStackTrace.implementation,o=r.run(t);return n?r.guessAnonymousFunctions(o):o}function __WL(){}h=window,k.when=function(){if(arguments.length<2){var e=arguments.length?arguments[0]:void 0;return e&&"function"==typeof e.isResolved&&"function"==typeof e.isRejected?e.promise():k().resolve(e).promise()}return function(n){for(var r=k(),o=n.length,i=0,s=new Array(o),e=0;e<n.length;e++)!function(e){var t;n[e].done?n[e].done(function(){s[e]=arguments.length<2?arguments[0]:arguments,++i==o&&r.resolve.apply(r,s)}).fail(function(){r.reject(arguments)}):(t=n[e],n[e]=new Deferred,n[e].done(function(){s[e]=arguments.length<2?arguments[0]:arguments,++i==o&&r.resolve.apply(r,s)}).fail(function(){r.reject(arguments)}).resolve(t))}(e);return r.promise()}(arguments)},k.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},h.Deferred=k,h.WLJQ=k,h.WLJQ.Deferred=function(){return new Deferred},"undefined"!=typeof module&&module.exports&&(module.exports=printStackTrace),printStackTrace.implementation=function(){},printStackTrace.implementation.prototype={run:function(e,t){return e=e||this.createException(),"other"===(t=t||this.mode(e))?this.other(arguments.callee):this[t](e)},createException:function(){try{this.undef()}catch(e){return console.warn("Se presento un error en la libreria ibmmfpf"),e}},mode:function(e){return e.arguments&&e.stack?"chrome":e.stack&&e.sourceURL?"safari":e.stack&&e.number?"ie":"string"==typeof e.message&&"undefined"!=typeof window&&window.opera?!e.stacktrace||-1<e.message.indexOf("\n")&&e.message.split("\n").length>e.stacktrace.split("\n").length?"opera9":e.stack?e.stacktrace.indexOf("called from line")<0?"opera10b":"opera11":"opera10a":e.stack?"firefox":"other"},instrumentFunction:function(e,t,n){var r=(e=e||window)[t];e[t]=function(){return n.call(this,printStackTrace().slice(4)),e[t]._instrumented.apply(this,arguments)},e[t]._instrumented=r},deinstrumentFunction:function(e,t){e[t].constructor===Function&&e[t]._instrumented&&e[t]._instrumented.constructor===Function&&(e[t]=e[t]._instrumented)},chrome:function(e){var t=(e.stack+"\n").replace(/^\S[^\(]+?[\n$]/gm,"").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}()@$1$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}()@$1").split("\n");return t.pop(),t},safari:function(e){return e.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(e){return e.stack.replace(/at Anonymous function /gm,"{anonymous}()@").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^.*at (\w+) \(([^\)]+)\)$/gm,"$1@$2").split("\n")},firefox:function(e){return e.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^[\(@]/gm,"{anonymous}()@").split("\n")},opera11:function(e){for(var t=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/,n=e.stacktrace.split("\n"),r=[],o=0,i=n.length;o<i;o+=2){var s,a,u=t.exec(n[o]);u&&(s=u[4]+":"+u[1]+":"+u[2],a=(a=u[3]||"global code").replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,"{anonymous}"),r.push(a+"@"+s+" -- "+n[o+1].replace(/^\s+/,"")))}return r},opera10b:function(e){for(var t=/^(.*)@(.+):(\d+)$/,n=e.stacktrace.split("\n"),r=[],o=0,i=n.length;o<i;o++){var s,a=t.exec(n[o]);a&&(s=a[1]?a[1]+"()":"global code",r.push(s+"@"+a[2]+":"+a[3]))}return r},opera10a:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),r=[],o=0,i=n.length;o<i;o+=2){var s,a=t.exec(n[o]);a&&(s=a[3]||"{anonymous}",r.push(s+"()@"+a[2]+":"+a[1]+" -- "+n[o+1].replace(/^\s+/,"")))}return r},opera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),r=[],o=2,i=n.length;o<i;o+=2){var s=t.exec(n[o]);s&&r.push("{anonymous}()@"+s[2]+":"+s[1]+" -- "+n[o+1].replace(/^\s+/,""))}return r},other:function(e){for(var t,n,r="{anonymous}",o=/function\s*([\w\-$]+)?\s*\(/i,i=[];e&&e.arguments&&i.length<10;)t=o.test(e.toString())&&RegExp.$1||r,n=Array.prototype.slice.call(e.arguments||[]),i[i.length]=t+"("+this.stringifyArguments(n)+")",e=e.caller;return i},stringifyArguments:function(e){for(var t=[],n=Array.prototype.slice,r=0;r<e.length;++r){var o=e[r];void 0===o?t[r]="undefined":null===o?t[r]="null":o.constructor&&(o.constructor===Array?o.length<3?t[r]="["+this.stringifyArguments(o)+"]":t[r]="["+this.stringifyArguments(n.call(o,0,1))+"..."+this.stringifyArguments(n.call(o,-1))+"]":o.constructor===Object?t[r]="#object":o.constructor===Function?t[r]="#function":o.constructor===String?t[r]='"'+o+'"':o.constructor===Number&&(t[r]=o))}return t.join(",")},sourceCache:{},ajax:function(e){var t=this.createXMLHTTPObject();if(t)try{return t.open("GET",e,!1),t.send(null),t.responseText}catch(e){console.warn("Se presento un error en la libreria ibmmfpf")}return""},createXMLHTTPObject:function(){for(var e,t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=0;n<t.length;n++)try{return e=t[n](),this.createXMLHTTPObject=t[n],e}catch(e){console.warn("Se presento un error en la libreria ibmmfpf")}},isSameDomain:function(e){return"undefined"!=typeof location&&-1!==e.indexOf(location.hostname)},getSource:function(e){return e in this.sourceCache||(this.sourceCache[e]=this.ajax(e).split("\n")),this.sourceCache[e]},guessAnonymousFunctions:function(e){for(var t=0;t<e.length;++t){var n,r,o,i,s,a=e[t],u=/\{anonymous\}\(.*\)@(.*)/.exec(a);!u||(n=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/.exec(u[1]))&&(r=n[1],o=n[2],i=n[3]||0,r&&this.isSameDomain(r)&&o&&(s=this.guessAnonymousFunction(r,o,i),e[t]=a.replace("{anonymous}",s)))}return e},guessAnonymousFunction:function(t,e,n){var r;try{r=this.findFunctionName(this.getSource(t),e)}catch(e){r="getSource failed with url: "+t+", exception: "+e.toString()}return r},findFunctionName:function(e,t){for(var n,r,o,i=/function\s+([^(]*?)\s*\(([^)]*)\)/,s=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,a=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,u="",l=Math.min(t,20),c=0;c<l;++c)if(0<=(o=(n=e[t-c-1]).indexOf("//"))&&(n=n.substr(0,o)),n){if(u=n+u,(r=s.exec(u))&&r[1])return r[1];if((r=i.exec(u))&&r[1])return r[1];if((r=a.exec(u))&&r[1])return r[1]}return"(?)"}};var WL=WL||{},Xc,Oe;function Yc(){}function Pe(e,t){for(var n=e.length,r=t.length;r--;)e[n+r]=t[r];return e}window.WLJSX={emptyFunction:function(){},$:function(e){var t=WLJQ("#"+e);return 0===t.length?null:t[0]},$$:function(e){return WLJQ(e)},$$$:function(e){var t=WLJQ(e);return 0===t.length?null:t[0]},find:function(e,t){return WLJQ(e).find(t)},newElement:function(e,t){return WLJQ(e,t)[0]},append:function(e,t){WLJQ(e).append(t)},prepend:function(e,t){WLJQ(e).prepend(t)},html:function(e,t){if(!t)return WLJQ(e).html();WLJQ(e).html(t)},empty:function(e){WLJQ(e).empty()},show:function(e){WLJQ(e).show()},hide:function(e){WLJQ(e).hide()},addClass:function(e,t){WLJQ(e).addClass(t)},removeClass:function(e,t){WLJQ(e).removeClass(t)},width:function(e,t){if(!t)return WLJQ(e).width();WLJQ(e).width(t)},height:function(e,t){if(!t)return WLJQ(e).height();WLJQ(e).height(t)},remove:function(e){WLJQ(e).remove()},css:function(e,t){WLJQ(e).css(t)},attr:function(e,t,n){if(!n)return WLJQ(e).attr(t);WLJQ(e).attr(t,n)},bind:function(e,t,n){WLJQ(e).bind(t,n)},unbind:function(e,t){t?WLJQ(e).unbind(t):WLJQ(e).unbind()},trigger:function(e,t){WLJQ(e).trigger(t)},eventTarget:function(e){return e.target},detectBrowser:function(){var e=navigator.userAgent,t="[object Opera]"==Object.prototype.toString.call(window.opera);return{isIE:!!window.attachEvent&&!t,isOpera:t,isWebKit:-1<e.indexOf("AppleWebKit/"),isGecko:-1<e.indexOf("Gecko")&&-1===e.indexOf("KHTML"),isMobileSafari:/Apple.*Mobile/.test(e),isWP81RT:-1<e.indexOf("Windows Phone 8.1")}},getViewportRootElement:function(){var e=WLJSX.detectBrowser();return e.isWebKit&&!document.evaluate?document:e.isOpera&&window.parseFloat(window.opera.version())<9.5?document.body:document.documentElement},getViewportWidth:function(){return this.getViewportRootElement().clientWidth},getViewportHeight:function(){return this.getViewportRootElement().clientHeight},isEmptyObject:function(e){return WLJQ.isEmptyObject(e)}},window.WLJSX.Class=(Xc=function(){for(var e in{toString:1})if("toString"===e)return!1;return!0}(),{create:function(){var e=null,t=WLJSX.Object.toArray(arguments);function n(){this.initialize.apply(this,arguments)}WLJSX.Object.isFunction(t[0])&&(e=t.shift()),WLJSX.Object.extend(n,WLJSX.Class.Methods),n.superclass=e,n.subclasses=[],e&&(Yc.prototype=e.prototype,n.prototype=new Yc,e.subclasses.push(n));for(var r=0,o=t.length;r<o;r++)n.addMethods(t[r]);return n.prototype.initialize||(n.prototype.initialize=WLJSX.emptyFunction),n.prototype.constructor=n},Methods:{addMethods:function(e){var t=this.superclass&&this.superclass.prototype,n=WLJSX.Object.keys(e);Xc&&(e.toString!=Object.prototype.toString&&n.push("toString"),e.valueOf!=Object.prototype.valueOf&&n.push("valueOf"));for(var r=0,o=n.length;r<o;r++){var i,s=n[r],a=e[s];t&&WLJSX.Object.isFunction(a)&&"__super"==a.argumentNames()[0]&&(i=a,(a=function(e){return function(){return t[e].apply(this,arguments)}}(s).wrap(i)).valueOf=i.valueOf.bind(i),a.toString=i.toString.bind(i)),this.prototype[s]=a}return this}}}),window.WLJSX.Object={_toString:Object.prototype.toString,NULL_TYPE:"Null",UNDEFINED_TYPE:"Undefined",BOOLEAN_TYPE:"Boolean",NUMBER_TYPE:"Number",STRING_TYPE:"String",OBJECT_TYPE:"Object",FUNCTION_CLASS:"[object Function]",BOOLEAN_CLASS:"[object Boolean]",NUMBER_CLASS:"[object Number]",STRING_CLASS:"[object String]",ARRAY_CLASS:"[object Array]",DATE_CLASS:"[object Date]",NATIVE_JSON_STRINGIFY_SUPPORT:window.JSON&&"function"==typeof JSON.stringify&&"0"===JSON.stringify(0)&&void 0===JSON.stringify(function(e){return e}),objectSize:function(e){var t=0;for(var n in e)t++;return t},toArray:function(e){if(!e)return[];if("toArray"in Object(e))return e.toArray();for(var t=e.length||0,n=new Array(t);t--;)n[t]=e[t];return n},Type:function(e){switch(e){case null:return WLJSX.Object.NULL_TYPE;case void 0:return WLJSX.Object.UNDEFINED_TYPE}switch(typeof e){case"boolean":return WLJSX.Object.BOOLEAN_TYPE;case"number":return WLJSX.Object.NUMBER_TYPE;case"string":return WLJSX.Object.STRING_TYPE}return WLJSX.Object.OBJECT_TYPE},extend:function(e,t){for(var n in t)e[n]=t[n];return e},toJSON:function(e){return WLJSX.Object.NATIVE_JSON_STRINGIFY_SUPPORT?JSON.stringify(e):WLJSX.Object.Str("",{"":e},[])},Str:function(e,t,n){var r=t[e];WLJSX.Object.Type(r)===WLJSX.Object.OBJECT_TYPE&&"function"==typeof r.toJSON&&(r=r.toJSON(e));var o=WLJSX.Object._toString.call(r);switch(o){case WLJSX.Object.NUMBER_CLASS:case WLJSX.Object.BOOLEAN_CLASS:case WLJSX.Object.STRING_CLASS:r=r.valueOf()}switch(r){case null:return"null";case!0:return"true";case!1:return"false"}switch(typeof r){case"string":return r;case"number":return isFinite(r)?String(r):"null";case"object":for(var i=0,s=n.length;i<s;i++)if(n[i]===r)throw new TypeError;n.push(r);var a=[];if(o===WLJSX.Object.ARRAY_CLASS){for(i=0,s=r.length;i<s;i++){var u=WLJSX.Object.Str(i,r,n);a.push(void 0===u?"null":u)}a="["+a.join(",")+"]"}else{for(var l=WLJSX.Object.keys(r),i=0,s=l.length;i<s;i++){e=l[i];var c=WLJSX.Object.Str(e,r,n);void 0!==c&&a.push(WLJSX.String.inspect(e,!0)+":"+c)}a="{"+a.join(",")+"}"}return n.pop(),a}},toQueryString:function(e){var t=[];for(var n in e){var r=e[n=encodeURIComponent(n)],o=WLJSX.Object.isUndefined(r)?n:n+"="+encodeURIComponent(WLJSX.String.interpret(r));t.push(o)}return t.join("&")},keys:function(e){if(WLJSX.Object.Type(e)!==WLJSX.Object.OBJECT_TYPE)throw new TypeError;var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},clone:function(e){return WLJSX.Object.extend({},e)},isArray:function(e){return"function"==typeof Array.isArray&&Array.isArray([])&&!Array.isArray({})?Array.isArray(e):WLJSX.Object._toString.call(e)===WLJSX.Object.ARRAY_CLASS},isFunction:function(e){return WLJSX.Object._toString.call(e)===WLJSX.Object.FUNCTION_CLASS},isString:function(e){return WLJSX.Object._toString.call(e)===WLJSX.Object.STRING_CLASS},isNumber:function(e){return WLJSX.Object._toString.call(e)===WLJSX.Object.NUMBER_CLASS},isDate:function(e){return WLJSX.Object._toString.call(e)===WLJSX.Object.DATE_CLASS},isUndefined:function(e){return void 0===e}},window.WLJSX.String={specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"},stripScripts:function(e){return e.replace(new RegExp("<script[^>]*>([\\S\\s]*?)<\/script>","img"),"")},escapeHTML:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},interpret:function(e){return null===e?"":String(e)},strip:function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},toQueryParams:function(e){var t=WLJSX.String.strip(e).match(/([^?#]*)(#.*)?$/);if(!t)return{};for(var n=t[1].split("&"),r={},o=0;o<n.length;o++){var i,s,a=n[o].split("=");a[0]&&(a.shift().toString().replace(/%/g,"%25"),i=decodeURIComponent(a.shift()),void 0!==(s=1<a.length?a.join("="):a[0])&&(s=decodeURIComponent(s)),r[i]=s)}return r},isJSON:function(e){return!WLJSX.String.isBlank(e)&&(e=(e=(e=e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@")).replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]")).replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(e))},isBlank:function(e){return/^\s*$/.test(e)},inspect:function(e,t){var n=e.replace(/[\x00-\x1f\\]/g,function(e){return e in WLJSX.String.specialChar?WLJSX.String.specialChar[e]:"\\u00"+e.charCodeAt().toPaddedString(2,16)});return t?'"'+n.replace(/"/g,'\\"')+'"':"'"+n.replace(/'/g,"\\'")+"'"},unfilterJSON:function(e){return e.replace(/^\/\*-secure-([\s\S]*)\*\/\s*$/,"$1")},evalJSON:function(str,sanitize){var json=WLJSX.String.unfilterJSON(str);if(window.JSON&&"function"==typeof JSON.parse&&JSON.parse('{"test": true}').test)return JSON.parse(json);var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;cx.test(json)&&(json=json.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));try{if(!sanitize||WLJSX.String.isJSON(json))return eval("("+json+")")}catch(e){return console.error("Se presento un error en la libreria ibmmfpf"),e}throw new SyntaxError("Badly formed JSON string: "+WLJSX.String.inspect(str))},parseResponseHeaders:function(e){var t={};if(null!=e)for(var n=-1<e.indexOf("\r")?"\r\n":"\n",r=e.split(n),o=0;o<r.length;o++){var i,s,a=r[o],u=a.indexOf(": ");0<u&&(i=a.substring(0,u),s=a.substring(u+2),t[i]=s)}return t},getHeaderByKey:function(e,t){for(var n in e)if(n.toLowerCase()===t.toLowerCase()){var r={};return r[t]=e[n],r}return null}},window.WLJSX.PeriodicalExecuter=function(e,t){var n=!1;var r=setInterval(function(){if(!n)try{n=!0,e(),n=!1}catch(e){throw n=!1,e}}.bind(this),1e3*t);return{execute:function(){e(this)},stop:function(){r&&(clearInterval(r),r=null)}}},WLJSX.Object.extend(Function.prototype,(Oe=Array.prototype.slice,{argumentNames:function(){var e=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return 1!=e.length||e[0]?e:[]},bind:function(e){function t(){}function n(){return o.apply(this instanceof t?this:e||{},r.concat(Array.prototype.slice.call(arguments)))}var r=Array.prototype.slice.call(arguments,1),o=this;return t.prototype=this.prototype||{},n.prototype=new t,n},bindAsEventListener:function(n){var r=this,o=Oe.call(arguments,1);return function(e){var t=Pe([e||window.event],o);return r.apply(n,t)}},curry:function(){if(!arguments.length)return this;var r=this,o=Oe.call(arguments,0);return function(){var e,t,n=(e=o,t=arguments,Pe(e=Oe.call(e,0),t));return r.apply(this,n)}},delay:function(e){var t=this,n=Oe.call(arguments,1);return e*=1e3,window.setTimeout(function(){return t.apply(t,n)},e)},defer:function(){var e=Pe([.01],arguments);return this.delay.apply(this,e)},wrap:function(t){var n=this;return function(){var e=Pe([n.bind(this)],arguments);return t.apply(this,e)}}})),WL.Validators={isValidationEnabled:!1,verbose:!0,isEvent:function(e){return e&&e.type},logAndThrow:function(e,t){throw WL.Logger&&(t&&(e="Invalid invocation of method "+t+"; "+e),this.verbose&&WL.Logger.error(e)),new Error(e)},enableValidation:function(){this.isValidationEnabled=!0},disableValidation:function(){this.isValidationEnabled=!1},validateArguments:function(e,t,n){e.length<t.length&&(e.length===t.length-1&&this.isEvent(t[t.length-1])||this.logAndThrow("Method was passed "+t.length+" arguments, expected only "+e.length+" "+WLJSX.Object.toJSON(e)+".",n)),this.validateArray(e,t,n)},validateMinimumArguments:function(e,t,n){e.length<t&&this.logAndThrow("Method passed: "+e.length+" arguments. Minimum arguments expected are: "+t+" arguments.",n)},validateArray:function(e,t,n){if(this.isValidationEnabled)for(var r=0;r<e.length;++r)this.validateArgument(e[r],t[r],n)},validateArgument:function(e,t,n){if(this.isValidationEnabled)switch(typeof e){case"function":e.call(this,t);break;case"string":typeof t!==e&&this.logAndThrow("Invalid value '"+WLJSX.Object.toJSON(t)+"' ("+typeof t+"), expected type '"+e+"'.",n);break;default:this.logAndThrow("Invalid or undefined validator for argument '"+WLJSX.Object.toJSON(t)+"'",n)}},validateOptions:function(e,t,n){this.validateObjectProperties(e,t,!0,n)},validateOptionsLoose:function(e,t,n){this.validateObjectProperties(e,t,!1,n)},validateObjectProperties:function(e,t,n,r){if(this.isValidationEnabled&&void 0!==t)for(var o in t){if(!e[o]){if(!n)continue;this.logAndThrow("Invalid options attribute '"+o+"', valid attributes: "+WLJSX.Object.toJSON(e),r)}try{this.validateArgument(e[o],t[o],r)}catch(e){this.logAndThrow("Invalid options attribute '"+o+"'. "+(e.message||e.description),r)}}},validateAllOptionTypes:function(e,t,n){if(this.isValidationEnabled&&void 0!==t){var r=!1;for(var o in t){r=!1;for(var i=0;i<e.length;++i)try{this.verbose=!1,this.validateArgument(e[i],t[o],n),r=!0;break}catch(e){return console.error("Se presento un error en la libreria ibmmfpf"),e}this.verbose=!0,r||this.logAndThrow("Invalid options attribute '"+o+"' ("+typeof t[o]+"). Please use just the following types: "+e.join(","),n)}}},validateStringOrNull:function(e,t){this.isValidationEnabled&&null!=e&&"string"!=typeof e&&this.logAndThrow("Invalid argument value '"+e+"', expected null or 'string'.",t)},validateNumberOrNull:function(e,t){this.isValidationEnabled&&null!=e&&"number"!=typeof e&&this.logAndThrow("Invalid argument value '"+e+"', expected null or 'number'.",t)},validateBooleanOrNull:function(e,t){this.isValidationEnabled&&null!=e&&"boolean"!=typeof e&&this.logAndThrow("Invalid argument value '"+e+"', expected null or 'boolean'.",t)},validateObjectOrNull:function(e,t){this.isValidationEnabled&&null!=e&&"object"!=typeof e&&this.logAndThrow("Invalid argument value '"+e+"', expected null or 'object'.",t)},validateArrayObjectOrNull:function(e,t){this.isValidationEnabled&&(null==e||Array.isArray(e)||this.logAndThrow("Invalid argument value '"+e+"', expected null or 'array'.",t))},validateFunctionOrNull:function(e,t){this.isValidationEnabled&&null!=e&&"function"!=typeof e&&this.logAndThrow("Invalid argument value '"+e+"', expected null or 'function'.",t)},validateURLOrNull:function(e,t){this.isValidationEnabled&&void 0!==e&&null!=e&&(e.match(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi)||this.logAndThrow("Invalid URL : "+e,t))},validateDefined:function(e,t){null==e&&this.logAndThrow("Invalid argument value '"+e+"', expected not empty string.",t)},isDefined:function(e){return null==e},validateNotEmptyString:function(e,t){this.isValidationEnabled&&("string"==typeof e&&0!=e.length||this.logAndThrow("Invalid argument value '"+e+"', expected not empty string.",t))},isNullOrUndefined:function(e){return null==e},isString:function(e){return"string"==typeof e},isBoolean:function(e){return"boolean"==typeof e},isNumber:function(e){return"number"==typeof e},isArray:function(e){return Array.isArray(e)}},__WLConfig=function(){var t,n,r,o;this.__getBaseURL=function(){return null==t&&(t=this.__getContext()+"/api"),t},this.__setBaseURL=function(e){WL.Validators.validateURLOrNull(e,"__setBaseURL"),t=e},this.__getApplicationName=function(){return n},this.__setApplicationName=function(e){WL.Validators.validateDefined(e,"__setApplicationName"),n=e},this.__getClientPlatform=function(){return"web"},this.__getApplicationData=function(){var e={};return e.clientPlatform=this.__getClientPlatform(),e.id=this.__getApplicationName(),e},this.__getServerRelativeTime=function(){return WL.Validators.isNullOrUndefined(o)?0:o},this.__setServerRelativeTime=function(e){WL.Validators.validateNumberOrNull(e,"__setServerRelativeTime"),o=e},this.__getContext=function(){return r},this.__setContext=function(e){r=e}},__WL.prototype.Config=new __WLConfig,WL.Config=new __WLConfig;var __WLErrorCode={UNEXPECTED_ERROR:"UNEXPECTED_ERROR",API_INVOCATION_FAILURE:"API_INVOCATION_FAILURE",USER_INSTANCE_ACCESS_VIOLATION:"USER_INSTANCE_ACCESS_VIOLATION",AUTHENTICATION_REQUIRED:"AUTHENTICATION_REQUIRED",DOMAIN_ACCESS_FORBIDDEN:"DOMAIN_ACCESS_FORBIDDEN",UNRESPONSIVE_HOST:"UNRESPONSIVE_HOST",LOGIN_FAILURE:"LOGIN_FAILURE",REQUEST_TIMEOUT:"REQUEST_TIMEOUT",PROCEDURE_ERROR:"PROCEDURE_ERROR",UNSUPPORTED_VERSION:"UNSUPPORTED_VERSION",UNSUPPORTED_BROWSER:"UNSUPPORTED_BROWSER",DISABLED_COOKIES:"DISABLED_COOKIES",CONNECTION_IN_PROGRESS:"CONNECTION_IN_PROGRESS",AUTHORIZATION_FAILURE:"AUTHORIZATION_FAILURE",CHALLENGE_HANDLING_CANCELED:"CHALLENGE_HANDLING_CANCELED",MINIMUM_SERVER:"MINIMUM_SERVER"};WL.Language={DIRECTION_LTR:0,DIRECTION_RTL:1,LANGUAGES_RTL:["he","iw","ar"]},__WL.prototype.ErrorCode=__WLErrorCode,WL.ErrorCode=__WLErrorCode;var isSessionDefault=!1;__WLLocalStorageDB=function(){var n,i=window.localStorage;function s(e){var t={session:isSessionDefault,global:!1};for(var n in e)t[n]=e[n];return i=t.session?window.sessionStorage:window.localStorage,t}function a(e,t){return t.global?e:n+"."+e}this.init=function(){n=WL.Config.__getApplicationName()},this.setItem=function(e,t,n){var r=a(e,s(n)),o=t?JSON.stringify(t):null;i.setItem(r,o)},this.getItem=function(e,t){var n=a(e,s(t)),r=i.getItem(n);return r?JSON.parse(r):null},this.removeItem=function(e,t){var n=a(e,s(t));i.removeItem(n)}},WL.LocalStorageDB=new __WLLocalStorageDB,__WLClient=function(){this.__chMap={},this.__globalHeaders={};var c={},o={};function n(e){this.realm=e,this.isWLHandler=!1,this.activeRequest=null,this.requestWaitingList=[],this.startChallengeHandling=function(e,t){if(null==this.activeRequest)this.activeRequest=e;else if(WLJSX.Object.isUndefined(e.options.fromChallengeRequest))return void this.requestWaitingList.push(e);this.handleChallenge(t)},this.handleChallenge=function(e){},this.clearWaitingList=function(){this.requestWaitingList=[]},this.releaseWaitingList=function(){if(0<this.requestWaitingList.length)for(var e=0;e<this.requestWaitingList.length;e++)this.requestWaitingList[e].removeExpectedAnswer(this.realm);this.requestWaitingList=[]},this.cancel=function(){0;var e,t,n=this.activeRequest;this.activeRequest=null,this.clearWaitingList(),null!==n&&void 0!==n.options&&void 0!==n.options.onAuthRequestFailure&&(e={status:0,responseJSON:{errorCode:WL.ErrorCode.CHALLENGE_HANDLING_CANCELED,errorMsg:"Challenge handler operation was cancelled."},responseText:"Challenge handler operation was cancelled."},t=new WL.Response(e,null),n.options.onAuthRequestFailure(t))},this.moveToWaitingList=function(e){this.requestWaitingList.push(e)},this.removeFromWaitingList=function(e){for(var t=0;t<this.requestWaitingList.length;t++)if(this.requestWaitingList[t]===e){spliced=this.requestWaitingList.splice(t-1,1);break}},WL.Client.__chMap[e]=this}this.addGlobalHeader=function(e,t){this.__globalHeaders[e]=t},this.__getGlobalHeaders=function(e){return this.__globalHeaders},this.getEnvironment=function(){return"web"},this.getMessageID=function(){return"messageId"},this.init=function(e){var t=WLJQ.Deferred();!function(e){WL.Validators.enableValidation();var t=(o=e).mfpContextRoot;WL.Validators.validateDefined(t,"init"),void 0!==e.sessionMode&&(!0!==e.sessionMode&&!1!==e.sessionMode||(isSessionDefault=e.sessionMode));var n=e.applicationId;WL.Validators.validateDefined(n,"init"),WL.Config.__setContext(t),WL.Config.__setApplicationName(n)}(e),WL.DAO.init(),wlanalytics.init(WL.BrowserManager.getWLUniqueID(),WL.Config.__getApplicationName(),WL.Config.__getContext());var n=void 0!==window.wlCommonInit;if(WL.Utils.setLocalization().always(function(){WL.CertManager.init().then(function(){n&&wlCommonInit(),t.resolve()},function(e){t.reject(e)})}),!n)return t.promise()},this.invokeProcedure=function(e,r){WL.Validators.validateOptions({onSuccess:"function",onFailure:"function",invocationContext:function(){},onConnectionFailure:"function",timeout:"number",fromChallengeRequest:"boolean"},r,"WL.Client.invokeProcedure"),r=extendWithDefaultOptions(r);var o=!1;var t={};(t=WLJSX.Object.isUndefined(r.timeout)?new WL.ResourceRequest("/adapters/"+e.adapter+"/"+e.procedure,WL.ResourceRequest.GET):new WL.ResourceRequest("/adapters/"+e.adapter+"/"+e.procedure,WL.ResourceRequest.GET,r.timeout)).setQueryParameter("params",WLJSX.Object.toJSON(e.parameters));WL.Client.getEnvironment();t.send().then(function(e){var t,n;o||(o=!0,!e.responseJSON||e.responseJSON&&!e.responseJSON.isSuccessful?((t=new WL.Response(e,r.invocationContext)).errorCode=WL.ErrorCode.PROCEDURE_ERROR,t.errorMsg="Procedure invocation error.",t.invocationResult=e.responseJSON,t.invocationResult&&t.invocationResult.errors&&(t.errorMsg+=" "+t.invocationResult.errors),WL.Logger.error(t.errorMsg),r.onFailure(t)):((n=new WL.Response(e,r.invocationContext)).invocationResult=e.responseJSON,r.onSuccess(n)))},function(e){var t;o||(o=!0,setConnected(!1),t=e.responseJSON.errorCode,!r.onConnectionFailure||t!=WL.ErrorCode.UNRESPONSIVE_HOST&&t!=WL.ErrorCode.REQUEST_TIMEOUT?r.onFailure(new WL.FailResponse(e,r.invocationContext)):r.onConnectionFailure(new WL.FailResponse(e,r.invocationContext)))})},this.pinTrustedCertificatePublicKey=function(e){},this.reloadApp=function(){document.location.reload()},this.setHeartBeatInterval=function(e){WL.Validators.validateArguments(["number"],arguments,"WL.Client.setHeartBeatInterval"),void 0!==WL.AuthorizationManager&&null!==WL.AuthorizationManager&&WL.AuthorizationManager.__sendHeartBeat(e)},this.setDeviceDisplayName=function(e,t){WL.Validators.validateArguments(["string",WL.Validators.validateObjectOrNull],arguments,"WL.Client.setDeviceDisplayName"),void 0!==t?WL.Validators.validateOptions({onSuccess:"function",onFailure:"function"},t,"WL.Client.setDeviceDisplayName"):t={onSuccess:function(){},onFailure:function(){}},WL.DeviceAuth.__setDeviceDisplayName(e,t.onSuccess,t.onFailure)},this.getDeviceDisplayName=function(e){WL.Validators.validateArguments(["object"],arguments,"WL.Client.getDeviceDisplayName"),WL.Validators.validateOptions({onSuccess:"function",onFailure:"function"},e,"WL.Client.getDeviceDisplayName"),WL.DeviceAuth.__getDeviceDisplayName(e.onSuccess,e.onFailure)},this.removeGlobalHeader=function(e){delete this.__globalHeaders[e]},this.getCookies=function(){},this.setCookie=function(e){},this.deleteCookie=function(e){},this.getLanguage=function(){},this.isWl401=function(e){if(401==e.status){var t=e.getHeader("WWW-Authenticate");if(void 0!==t&&"MFP-Challenge"==t)return!0}return!1},this.isGatewayResponse=function(e){for(var t in WL.Client.__chMap)if(Object.prototype.hasOwnProperty.call(WL.Client.__chMap,t)){var n=WL.Client.__chMap[t];if(!n.isWLHandler&&n.canHandleResponse(e))return!0}},this.isWl403=function(e){return!(403!=e.status&&222!=e.status||void 0===e.responseJSON||null==e.responseJSON||!e.responseJSON.failures)},this.checkResponseForChallenges=function(i,e,t){var n=!1;if(void 0!==e.responseJSON&&null!=e.responseJSON&&"undefined"!==e.responseJSON.successes&&null!=e.responseJSON.successes&&(successes=e.responseJSON.successes,function(e){for(var t in e){var n;Object.prototype.hasOwnProperty.call(e,t)&&(c[t]=e[t],void 0!==(n=WL.Client.__chMap[t])&&n.isWLHandler&&(n.handleSuccess(e[t]),n.releaseWaitingList()))}}(successes)),this.isWl401(e)){var r=e.responseJSON.challenges;if(i.setExpectedAnswers(r),s=function(e){for(var t in e)if("directUpdate"==t)return t;return null}(r))l(r,s);else for(s in r)l(r,s);n=!0}else if(this.isWl403(e)){var o=e.responseJSON.failures;for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&null!=(u=this.__chMap[s])&&void 0!==u&&(u.handleFailure(o[s],i,e),u.clearWaitingList(),i.onFailure(e));n=!0}else for(var a in WL.Client.__chMap)if(Object.prototype.hasOwnProperty.call(WL.Client.__chMap,a)){var u=WL.Client.__chMap[a];if(!u.isWLHandler&&u.canHandleResponse(e)){u.startChallengeHandling(i,e),n=!0;break}}function l(e,t){var n,r,o;Object.prototype.hasOwnProperty.call(e,t)&&(null==(n=WL.Client.__chMap[t])||void 0===n?(r="unknown challenge arrived, cannot proccess challenge handler: "+t+". register challenge handler using WL.Client.createSecurityCheckChallengeHandler()",WL.Logger.error(r),o={status:-1,responseJSON:{errorCode:WL.ErrorCode.UNEXPECTED_ERROR,errorMsg:r}},i.onFailure(o)):n.startChallengeHandling(i,e[t]))}return n},this.createGatewayChallengeHandler=function(e){var t=new n(e);return t.isWLHandler=!1,t.submitSuccess=function(){t.activeRequest.removeExpectedAnswer(this.realm),t.activeRequest=null,t.releaseWaitingList()},t.canHandleResponse=function(e){return!1},t.submitLoginForm=function(e,t,n){var r=null;function o(e){d()||(f(),n(e))}WL.Logger.debug("Request [login]"),function(e){null!==r&&window.clearTimeout(r);r=window.setTimeout(p,e)}(WLJSX.Ajax.WLRequest.options.timeout);var i=WL.CookieManager.createCookieHeaders();if(t&&t.headers){var s=t.headers;if(void 0!==s&&null!=s)for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(i[a]=s[a])}var u={method:"post",contentType:"application/x-www-form-urlencoded",onSuccess:o,onFailure:o,on0:function(e){d()||(f(),WLJSX.Ajax.WLRequest.setConnected(!1),n(e))}.bind(this),requestHeaders:i};u.parameters=t.parameters;var l=null,l=0==e.indexOf("http")&&0<e.indexOf(":")?e:WL.Utils.createAPIRequestURL(e),c=null;function p(){(r=null)!==c&&c.transport.abort();var e={};e.responseJSON={errorCode:WL.ErrorCode.REQUEST_TIMEOUT,errorMsg:WL.ClientMessages.requestTimeout},e.responseText=null,n(e)}function f(){null!==r&&(window.clearTimeout(r),r=null)}function d(){return null===r}c=new WLJSX.Ajax.Request(l,u)},t},this.createSecurityCheckChallengeHandler=function(e){var t=new n(e);return t.isWLHandler=!0,t.MAX_NUMBER_OF_FAILURES=3,t.numOfFailures=0,t.submitChallengeAnswer=function(e){void 0===e||null==e?t.activeRequest.removeExpectedAnswer(this.realm):t.activeRequest.submitAnswer(this.realm,e),t.activeRequest=null},t.handleSuccess=function(e){},t.handleFailure=function(e){},t},this.__handleOnRemoteDisableDenial=function(e,t,n,r){o.onErrorRemoteDisableDenial?o.onErrorRemoteDisableDenial(n,r):e(t,n,r)},this.isShowCloseButtonOnRemoteDisable=function(){return!!o.showCloseOnRemoteDisableDenial}},__WL.prototype.Client=new __WLClient,WL.Client=new __WLClient,WL.JWT=WLJSX.Class.create({iss:null,sub:null,exp:0,iat:0,jti:null,aud:null,initialize:function(e,t){var n=(new Date).getTime()+WL.Config.__getServerRelativeTime();this.iss=WL.Config.__getApplicationName()+"$"+WL.Config.__getClientPlatform(),this.sub=WLAuthorizationManager.__getClientId(),this.exp=n+6e4,this.iat=n,this.jti=void 0===e?null:e,this.aud=void 0===t?null:t}}),WL.AccessToken=WLJSX.Class.create({value:null,expiration:0,scope:null,asAuthorizationRequestHeader:null,asFormEncodedBodyParameter:null,initialize:function(e,t,n){var r=(new Date).getTime();this.value=e,this.expiration=r+1e3*t,this.scope=n,this.asAuthorizationRequestHeader="Bearer "+e,this.asFormEncodedBodyParameter="access_token="+e}}),__WLBrowserManager=function(){var t;this.getWLUniqueID=function(){var e="com.mfp.browser.uniqueid",t={global:!0},n=WL.DAO.getItem(e,t);function r(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return WL.Validators.isNullOrUndefined(n)&&(n=r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r(),WL.DAO.setItem(e,n,t)),n},this.__setLocalDeviceDisplayName=function(e){t=e},this.getDeviceData=function(){var e={};return e.id=this.getWLUniqueID(),e.platform=window.navigator.userAgent,e.hardware=window.navigator.platform,e.deviceDisplayName=t,e}},__WL.prototype.BrowserManager=new __WLBrowserManager,WL.BrowserManager=new __WLBrowserManager,window.WLJSX.Ajax={getTransport:function(){var e=null;try{e=new XMLHttpRequest}catch(e){return console.error("Se presento un error en la libreria ibmmfpf"),e}return e}},window.WLJSX.Ajax.Request=WLJSX.Class.create({_complete:!1,initialize:function(e,t){this.options={method:"post",asynchronous:!0,contentType:"application/json",encoding:"UTF-8",parameters:"",evalJSON:!0,evalJS:!0},WLJSX.Object.extend(this.options,t||{}),this.options.method=this.options.method.toLowerCase(),this.transport=window.WLJSX.Ajax.getTransport(),this.request(e)},request:function(e){this.url=e,this.method=this.options.method;var t=WLJSX.Object.isString(this.options.parameters)?this.options.parameters:WLJSX.Object.toJSON(this.options.parameters);"get"!==this.method&&"post"!==this.method&&"put"!==this.method&&(t+=(t?"&":"")+"_method="+this.method,this.method="post"),t&&"get"===this.method&&(t=WLJSX.Object.toQueryString(this.options.parameters),this.url+=(-1<this.url.indexOf("?")?"&":"?")+t),(t&&"post"===this.method.toLowerCase()||"put"===this.method.toLowerCase())&&(t="application/x-www-form-urlencoded"===this.options.contentType?WLJSX.Object.toQueryString(this.options.parameters):WLJSX.Object.toJSON(this.options.parameters));try{var n=new window.WLJSX.Ajax.Response(this);this.options.onCreate&&this.options.onCreate(n),this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous),this.transport.timeout=this.options.timeout,this.options.asynchronous&&this.respondToReadyState.bind(this).defer(1),this.transport.onreadystatechange=this.onStateChange.bind(this),this.setRequestHeaders(),this.body="post"==this.method||"put"==this.method?this.options.postBody||t:null,this.transport.send(this.body),!this.options.asynchronous&&this.transport.overrideMimeType&&this.onStateChange()}catch(e){this.dispatchException(e)}},onStateChange:function(){var e=this.transport.readyState;1<e&&(4!=e||!this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var e={"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*","Accept-Language":WL.App.__getDeviceLocale()};if("post"!=this.method&&"put"!==this.method.toLowerCase()||(e["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:""),this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005&&(e.Connection="close")),"object"==typeof this.options.requestHeaders){var t=this.options.requestHeaders;if(WLJSX.Object.isFunction(t.push))for(var n=0,r=t.length;n<r;n+=2)e[t[n]]=t[n+1];else for(var o in t){var i=t[o];e[o]=null==i?"":i}}for(var s in e)this.transport.setRequestHeader(s,unescape(encodeURIComponent(e[s])))},success:function(){var e=this.getStatus();return(0!==e||!1!==this.isSameOrigin())&&(!e||200<=e&&e<300||304==e||302==e)},getStatus:function(){try{return 1223===this.transport.status?204:this.transport.status||0}catch(e){return console.warn("Se presento un error en la libreria ibmmfpf"),0}},respondToReadyState:function(e){var t=window.WLJSX.Ajax.Request.Events[e],n=new window.WLJSX.Ajax.Response(this);if("Complete"==t){try{this._complete=!0,(this.options["on"+n.status]||this.options["on"+(this.success()?"Success":"Failure")]||WLJSX.emptyFunction)(n,n.headerJSON)}catch(e){this.dispatchException(e)}var r=n.getHeader("Content-type");("force"==this.options.evalJS||this.options.evalJS&&this.isSameOrigin()&&r&&r.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))&&this.evalResponse()}try{(this.options["on"+t]||WLJSX.emptyFunction)(n,n.headerJSON)}catch(e){this.dispatchException(e)}"Complete"==t&&(this.transport.onreadystatechange=WLJSX.emptyFunction)},isSameOrigin:function(){var e=this.url.match(/^\s*https?:\/\/[^\/]*/),t=location.protocol+"//"+document.domain;return location.port&&(t+=":"+location.port),!e||e[0]==t},getHeader:function(e){try{return this.transport.getResponseHeader(e)||null}catch(e){return console.warn("Se presento un error en la libreria ibmmfpf"),e}},evalResponse:function(){try{return eval(WLJSX.String.unfilterJSON(this.transport.responseText||""))}catch(e){this.dispatchException(e)}},dispatchException:function(e){(this.options.onException||WLJSX.emptyFunction)(this,e)}}),window.WLJSX.Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"],window.WLJSX.Ajax.Response=WLJSX.Class.create({initialize:function(e){this.request=e;var t,n=this.transport=e.transport,r=this.readyState=n.readyState;(2<r&&!WLJSX.detectBrowser().isIE||4==r)&&(this.status=this.getStatus(),this.statusText=this.getStatusText(),this.responseText=WLJSX.String.interpret(n.responseText),this.headerJSON=this._getHeaderJSON()),4==r&&(t=n.responseXML,this.responseXML=WLJSX.Object.isUndefined(t)?null:t,this.responseJSON=this._getResponseJSON())},status:0,statusText:"",getStatus:window.WLJSX.Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(e){return console.warn("Se presento un error en la libreria ibmmfpf - statusText"),""}},getHeader:window.WLJSX.Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(e){return console.warn("Se presento un error en la libreria ibmmfpf - allHeaders"),e}},getResponseHeader:function(e){return this.transport.getResponseHeader(e)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var e=this.getHeader("X-JSON");if(!e)return null;e=decodeURIComponent(escape(e));try{return String.wl.evalJSON(e,this.request.options.sanitizeJSON||!this.request.isSameOrigin())}catch(e){this.request.dispatchException(e)}},_getResponseJSON:function(){var t=this.request.options;try{return WLJSX.String.evalJSON(this.responseText,t.sanitizeJSON||!this.request.isSameOrigin())}catch(e){if(!t.evalJSON||"force"!=t.evalJSON&&(this.getHeader("Content-type")||"").indexOf("application/json")<0||WLJSX.String.isBlank(this.responseText))return console.warn("Se presento un error en la libreria ibmmfpf - getResponseJSON"),e;this.request.dispatchException(e)}}}),__WLApp=function(){this.__openURL=function(e,t,n){WL.Validators.validateArguments(["string",WL.Validators.validateStringOrNull,WL.Validators.validateStringOrNull],arguments,"WL.App.openURL");!WLJSX.Object.isUndefined(n)&&null!==n||(n="status=1,toolbar=1,location=1,menubar=1,directories=1,resizable=1,scrollbars=1"),!WLJSX.Object.isUndefined(t)&&null!==t||(t="_self");var r=WL.Utils.createAPIRequestURL(e);return window.open(r,t,n)},this.__getDeviceLocale=function(){return null!=navigator.languages&&""!==navigator.languages[0]?navigator.languages[0]:null==navigator.language?navigator.browserLanguage:navigator.language},this.__getDeviceLanguage=function(){return this.__getDeviceLocale().substring(0,2)},this.getLocalePattern=function(){return pattern=WL.Client.getLocalePattern(),pattern},this.getDecimalSeparator=function(){var e=this.getLocalePattern();return null==e?".":e.decimal},this.getErrorMessage=function(e){var t;return null===e?t=null:WLJSX.Object.isString(e)?t=e:WLJSX.Object.isArray(e)?t=e.join(","):e.description||e.message?(t=e.description?e.description:e.message,e.fileName?t+=" ["+e.fileName+": line "+e.lineNumber+"]":e.sourceURL&&(t+=" ["+e.sourceURL+": line "+e.line+"]")):t=e.toString(),t}},__WL.prototype.App=new __WLApp,WL.App=new __WLApp;var __WLUtils=function(){var s="ibmmfpf";function i(e,t){var n=WLJQ.Deferred(),r="lib/messages/"+t+"/messages.json";return null!=t&&0!==t.indexOf("en")||(r="lib/messages/messages.json"),function(e){var t=WLJQ.Deferred(),n=new XMLHttpRequest;n.overrideMimeType&&n.overrideMimeType("application/json");return n.open("GET",e,!0),n.onreadystatechange=function(){4==n.readyState&&("200"==n.status?t.resolve(JSON.parse(n.responseText)):t.reject())},n.send(null),t.promise()}(e+r).then(function(e){WL.ClientMessages=e,n.resolve()},function(){WL.Logger.error("error loading messages file: "+r),n.reject()}),n.promise()}var a,u=function(e){for(var t=null,n=document.getElementsByTagName("script"),r="/"+e+".js",o=n.length-1;-1<o;o--){var i=n[o].src.replace(/\?.*$/,"");if(i.indexOf(r)===i.length-r.length){t=i.substring(0,i.length-r.length)+"/";break}}return t};this.wlReachableCallback=function(){},this.__networkCheckTimeout=function(){window.connectivityCheckDone||(WL.Logger.debug("Connectivity check has timed out"),window.connectivityCheckDone=!0)},this.safeGetValue=function(e){return WLJSX.Object.isUndefined(e)?null:e},this.formatString=function(){for(var e=arguments[0],t=1;t<arguments.length;t++)var n=new RegExp("\\{"+(t-1)+"\\}","g"),e=e.replace(n,arguments[t]);return e},this.loadLibrary=function(e,t){var n,r,o,i=u(s);"function"==typeof define&&define.amd?require([i+e],t):(n=e,r=u(s),(o=document.createElement("script")).src=r+n,document.head.appendChild(o))},this.setLocalization=function(){var e=WLJQ.Deferred(),t=WL.App.__getDeviceLocale();if(void 0===WL.ClientMessages||a!==t){a=t,WL.ClientMessages=void 0;var n=t.substring(0,2),r=t.substring(3),t=n.toLowerCase();r&&(t+="-"+r.toUpperCase()),-1!==t.indexOf("zh-HANS")?t="zh":-1===t.indexOf("zh-HANT")&&-1===t.indexOf("zh-HK")||(t="zh-TW");try{if(void 0===WL.ClientMessages){var o=u(s);if(!o)return WL.Logger.error("could not find "+s+".js, please rename MobileFirst SDK name to: "+s+".js"),e.reject();i(o,t).always(function(){void 0===WL.ClientMessages?i(o,n).always(function(){void 0===WL.ClientMessages?i(o,"en").always(function(){e.resolve()}):e.resolve()}):e.resolve()})}else e.resolve()}catch(e){WL.Logger.error(e)}}return e.promise()},this.getLanguageDirectionality=function(e){"string"!=typeof e&&(e=WL.App.__getDeviceLanguage());for(var t=0;t<WL.Language.LANGUAGES_RTL.length;t++)if(-1!==e.indexOf(WL.Language.LANGUAGES_RTL[t]))return WL.Language.DIRECTION_RTL;return WL.Language.DIRECTION_LTR},this.createAPIRequestURL=function(e){return e},this.extend=function(e,t){return e=WLJSX.Object.extend(WLJSX.Object.clone(t),e)},this.getHostname=function(e){var t=new RegExp("^(?:f|ht)tp(?:s)?://([^/:]+)","im");return e.match(t)[1].toString()},this.dispatchWLEvent=function(e,t){var n;void 0===document.createEvent?WLJSX.trigger(document,e):((n=document.createEvent("Events")).initEvent(e,!1,!1),null!==t&&(n.data=t),document.dispatchEvent(n))},this.versionCompare=function(e,t,n){var r=0,o=e.split("."),i=t.split("."),s=Math.min(o.length,i.length),a=n||5;if(e===t)return 0;for(r=0;r<s;r+=1){if(parseInt(o[r],10)>parseInt(i[r],10))return 1;if(parseInt(o[r],10)<parseInt(i[r],10))return-1;if(a<=r)break;if(o.length>i.length)return 1;if(o.length<i.length)return-1}return 0}},Tm,Um,Wm,Xm,Ym,_m,an,bn,dn,en,fn,gn,hn,jn,wn,yn,En,Kn,Mn,Nn,Qn,Sn,Tn,Un,Vn,Wn,Xn,Yn,bo,io,ko,oo,po,qo,Vt,Wt,Xt,Yt,Zt,_t,bu,cu,du,eu,fu,ju,vv;function ln(e,t,n){var r=WL.DAO.getItem(e,jn)||{};r[t]=n,WL.DAO.setItem(e,r,jn)}function mn(e,t){return(WL.DAO.getItem(e,jn)||{})[t]}function nn(e,t){ln(e,t,null)}function pn(e){var t,n=ro(e),r=mn(en,n);return!ko(r)&&(t=r,(new Date).getTime()>=t.expiration)&&(nn(en,n),r=null),r}function rn(e,t){var n=ro(e);ln(en,n,t)}function tn(e){return ko(e)?null:pn(e)}function zn(r){Hn(r,null).then(function(){Yn(r).then(function(e){var t,n;t=e,n=WLJQ.Deferred(),function(n){var r=WLJQ.Deferred(),e=new WL.JWT(n,"az/v1/token");return WL.CertManager.signJWS(e,{kid:Un()}).then(function(e){var t={client_assertion:e,code:n,grant_type:"authorization_code",redirect_uri:Co(),client_assertion_type:an};r.resolve(t)},function(e){r.reject(e)}),r.promise()}(t).then(function(e){xo("az/v1/token",Sn(n,e),!0)}),n.promise().then(function(e){rn(r,e),Bn(Un(),r,e,!0)},function(e){qo(e,r,Un(),{retryFunction:zn})})},function(e){qo(e,r,Un(),{retryFunction:zn})})},function(e){qo(e,r,Un(),{retryFunction:zn})})}function Bn(e,t,n,r){for(var o=[],i=[],s=0;s<wn.length;s++){var a=wn[s];t===a.scope&&(i.push(a),o.push(s))}for(var u=o.length-1;0<=u;u--)wn.splice(o[u],1);0<wn.length&&zn(wn[0].scope);for(var l=0;l<i.length;l++)r?i[l].deferred.resolve(n):i[l].deferred.reject(n)}function Cn(e){var t=wn.slice();dn=!(wn=[]);for(var n=0;n<t.length;n++)t[n].deferred.reject(e)}function Fn(e,t){var n=En.slice();En=[];for(var r=0;r<n.length;r++)t?n[r].resolve(e):n[r].reject(e)}function Hn(e,t){var n,r=WLJQ.Deferred(),o=Tn(r);return o.parameters[Tm]=Un(),ko(e)||(o.parameters[Um]=e),ko(t)||((n={})[e]=t,o.parameters[Wm]=n),xo("preauth/v1/preauthorize",o,!1),r.promise()}function Ln(e){if(WL.Client.isGatewayResponse(e))return 1;if(null!=e.responseJSON&&"server_version"in e.responseJSON){var t=e.responseJSON.server_version.split(".");return Mn(t,"8.0.2017020513".split("."))<1}return 1}function On(e){for(;e.length<Nn;)e="0"+e;return e}function ao(){var e=WL.DAO.getItem("com.mfp.authorization.url");return ko(e)&&(e=WL.Config.__getBaseURL()),e}function lo(e,t,n){wo()?Wn().then(function(){mo(e,t,Un(),n)},function(e){Cn(e),n.reject(e),Xn()}):mo(e,t,Un(),n)}function mo(t,n,r,o){Hn(t,n).then(function(e){WL.Logger.debug("Successfully logged in to security check: "+t),Bn(0,t,e,!(dn=!1)),o.resolve(e)},function(e){qo(e,t,r,{retryFunction:oo,userCallbackDfd:o,credentials:n})})}function ro(e){if(null==e||e===bn)return bn;e.indexOf(bn)<0&&(e+=" "+bn);var t=(e=e.replace(/  +/g," ").trim()).match(/\S+/g);return t.sort(),t.join(" ")}function to(e){return e||WL.DAO.removeItem(gn),WL.DAO.setItem(gn,e)}function vo(e){var n,r,t,o=WLJQ.Deferred();return n=e,r=WLJQ.Deferred(),t=new WL.JWT,WL.CertManager.signJWS(t,{kid:Un()}).then(function(e){var t={client_assertion:e,security_check:n,client_assertion_type:an};r.resolve(t)}),r.promise().then(function(e){xo("preauth/v1/logout",Qn(o,e),!1)}),o.promise()}function wo(){var e=Un();if(ko(e))return 1;var t=WL.DAO.getItem(gn),n=WL.BrowserManager.getDeviceData();return JSON.stringify(t)!==JSON.stringify(n)}function xo(e,t,n){var r=bo(n);return new WLJSX.Ajax.WLRequest(r+"/"+e,t)}function Co(){return WL.Config.__getBaseURL()+_m+"/"+Un()}function Eo(e,t,n){var r={status:e,responseJSON:{errorCode:t,errorMsg:n}};return new WL.Response(r,null)}function iu(e){var t,n,r="";return ju()?r=Yt[e]:0<document.cookie.length&&(-1!==(t=document.cookie.indexOf(e+"="))&&(t=t+e.length+1,-1===(n=document.cookie.indexOf(";",t))&&(n=document.cookie.length),r=decodeURI(document.cookie.substring(t,n)))),void 0===r&&(r=null),{name:e,value:r}}__WL.prototype.Utils=new __WLUtils,WL.Utils=new __WLUtils,"function"!=typeof Promise&&WL.Utils.loadLibrary("node_modules/promiz/promiz.min.js",function(e){}),WLJSX.Ajax.Request.prototype.isSameOrigin=function(){var e=this.url.match(/^\s*https?:\/\/[^\/]*/);try{var t=location.protocol+"//"+document.domain;return location.port&&(t+=":"+location.port),!e||e[0]===t}catch(e){return!!e}},WL.Response=WLJSX.Class.create({invocationContext:null,status:-1,errorCode:null,errorMsg:null,responseText:"",responseJSON:"",initialize:function(e,t){if(this.responseHeaders={},null!==e&&void 0!==e.status){this.status=e.status||200,this.responseHeaders={};try{this.responseText=WLJSX.String.interpret(e.responseText)}catch(e){return console.error("Se presento un error en la libreria ibmmfpf"),e}try{this.responseJSON=WLJSX.String.evalJSON(e.responseText,!0)}catch(e){return console.error("Se presento un error en la libreria ibmmfpf"),e}var n;void 0!==e.responseJSON&&null!==e.responseJSON&&(this.errorCode=e.responseJSON.errorCode,void 0!==e.responseJSON.error&&null!==e.responseJSON.error?this.errorMsg=e.responseJSON.error:this.errorMsg=e.responseJSON.errorMsg),"function"==typeof e.getAllResponseHeaders&&(n=e.getAllResponseHeaders(),this.responseHeaders=WLJSX.String.parseResponseHeaders(n))}this.invocationContext=t},getHeaderNames:function(){var e=[];for(var t in this.responseHeaders)e.push(t);return e},getAllHeaders:function(){return this.responseHeaders},getHeader:function(e){return null==e?null:this.responseHeaders[e]}}),WL.FailResponse=WLJSX.Class.create({invocationContext:null,status:-1,errorCode:null,errorMsg:null,initialize:function(e,t){null!==e&&void 0!==e.status&&(this.status=e.status||200,null!==e.responseJSON&&void 0!==e.responseJSON&&(this.errorCode=e.responseJSON.errorCode,this.errorMsg=e.responseJSON.errorMsg)),this.invocationContext=t}}),window.WLJSX.Ajax.WlRequestPiggyBackers=[],window.WLJSX.Ajax.WLRequest=WLJSX.Class.create({instanceId:null,wlAnswers:{},postAnswerRealm:"",MAX_AUTH_HEADER_SIZE:900,MAX_TOTAL_HEADER_SIZE:3e3,MAX_CONFLICT_ATTEMPTS:7,initialize:function(e,t){this.options=WLJSX.Object.clone(WLJSX.Ajax.WLRequest.options),WLJSX.Object.extend(this.options,t||{}),this.url=e,this.callerOptions=t,this.isTimeout=!1,this.timeoutTimer=null,this.conflictCounter=0,this.options.onSuccess=this.onWlSuccess.bind(this),this.options.onFailure=this.onWlFailure.bind(this),this.options.onException=this.onException.bind(this),this.options.on0=this.onUnresponsiveHost.bind(this),!WLJSX.Object.isUndefined(this.options.parameters)&&null!==this.options.parameters&&""!==this.options.parameters||(this.options.parameters={});for(var n=0;n<WLJSX.Ajax.WlRequestPiggyBackers.length;n++){var r=WLJSX.Ajax.WlRequestPiggyBackers[n];"function"==typeof r.processOptions&&r.processOptions(this.options,e)}this.wlAnswers={},this.sendRequest()},createRequestHeaders:function(){var e={};if(void 0!==this.wlAnswers){var t={},n=!1;for(var r in this.wlAnswers)if(Object.prototype.hasOwnProperty.call(this.wlAnswers,r)){var o="";try{o=JSON.parse(this.wlAnswers[r])}catch(e){o=this.wlAnswers[r]}"string"==typeof o&&"undefined"==typeof JSON?t[r]=0===o.indexOf('"')?o:'"'+o+'"':t[r]=o,n=!0}!0===n&&(this.options.parameters.challengeResponse=t)}this.__addGlobalHeaders(e);var i=this.options.optionalHeaders;if(null!=i)for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s]);return e},sendRequest:function(e){this.options.requestHeaders=void 0===e?this.createRequestHeaders():e;var t={},n=WLJSX.Object.toJSON(this.options.requestHeaders).length,r=void 0===this.options.requestHeaders.Authorization?-1:WLJSX.Object.toJSON(this.options.requestHeaders.Authorization).length;(n>this.MAX_TOTAL_HEADER_SIZE||r>this.MAX_AUTH_HEADER_SIZE)&&-1<r&&((t=WL.Utils.extend(t,this.options)).requestHeaders=this.options.requestHeaders,t.onSuccess=this.onPostAnswersSuccess.bind(this),t.onFailure=this.onPostAnswersFailure.bind(this),t.postBody=this.options.requestHeaders.Authorization,t.requestHeaders.Authorization="wl-authorization-in-body",t.method="post",this.wlAnswers={}),void 0!==this.options.requestHeaders.Authorization&&(this.wlAnswers={}),0<this.options.timeout&&(this.timeoutTimer=window.setTimeout(this.handleTimeout.bind(this),this.options.timeout));var o=this;new WLJSX.Ajax.Request(o.url,o.options)},__addGlobalHeaders:function(e){if(void 0!==WL.Client.__globalHeaders&&null!==WL.Client.__globalHeaders)for(var t in WL.Client.__globalHeaders)Object.prototype.hasOwnProperty.call(WL.Client.__globalHeaders,t)&&(e[t]=WL.Client.__globalHeaders[t])},onSuccessParent:function(e,t){if(!this.isTimeout)return this.cancelTimeout(),WL.Client.checkResponseForChallenges(this,e,t)},onPostAnswersSuccess:function(e){this.onSuccessParent(e,this.postAnswerRealm),this.postAnswerRealm=""},onWlSuccess:function(e){this.isTimeout||this.onSuccessParent(e)||this.onSuccess(e)},onSuccess:function(e){var t;null!==e.getAllHeaders()&&(t=e.getAllHeaders().split("\n"),WL.CookieManager.handleResponseHeaders(t));for(var n=0;n<WLJSX.Ajax.WlRequestPiggyBackers.length;n++){var r=WLJSX.Ajax.WlRequestPiggyBackers[n];"function"==typeof r.onSuccess&&r.onSuccess(e,this.options)}"function"==typeof this.callerOptions.onSuccess&&this.callerOptions.onSuccess(e)},onPostAnswersFailure:function(e){this.isTimeout||(this.cancelTimeout(),WL.Client.removeFromWaitingListOnPostAnsweresWlReponse(e,this,this.postAnswerRealm),WL.Client.checkResponseForChallenges(this,e,this.postAnswerRealm),this.postAnswerRealm="")},onWlFailure:function(e){var t,n;this.isTimeout||(this.cancelTimeout(),e&&e.getAllHeaders&&null!==e.getAllHeaders()&&(t=e.getAllHeaders(),WLJSX.Object.isString(t)&&(n=t.split("\n"),WL.CookieManager.handleResponseHeaders(n))),409===e.status&&WLAuthorizationManager.isAuthorizationRequired(e.status,e.getAllResponseHeaders())&&this.conflictCounter++<this.MAX_CONFLICT_ATTEMPTS?this.sendRequest():WL.Client.checkResponseForChallenges(this,e)||this.onFailure(e))},onFailure:function(t){var e,n;if(t&&t.getAllHeaders&&null!==t.getAllHeaders()&&(e=t.getAllHeaders(),WLJSX.Object.isString(e)&&(n=e.split("\n"),WL.CookieManager.handleResponseHeaders(n))),null===t.responseJSON)try{t.responseJSON=WLJSX.String.evalJSON(t.responseText,!0)}catch(e){t.responseJSON={errorCode:WL.ErrorCode.UNEXPECTED_ERROR,errorMsg:"unexpected error"}}var r=this.getCallbackForErrorCode(t.responseJSON.errorCode);if(r&&r(this,t),t.responseJSON.errorCode!==WL.ErrorCode.USER_INSTANCE_ACCESS_VIOLATION){for(var o=0;o<WLJSX.Ajax.WlRequestPiggyBackers.length;o++){var i=WLJSX.Ajax.WlRequestPiggyBackers[o];"function"==typeof i.onFailure&&i.onFailure(t,this.options)}"function"==typeof this.callerOptions.onFailure&&this.callerOptions.onFailure(t)}else WLJSX.Ajax.WLRequest.options.onAuthentication(this,t)},getCallbackForErrorCode:function(e){return this.options["on"+e]},onException:function(e,t){this.isTimeout||(this.cancelTimeout(),"function"==typeof this.options.onAuthException&&this.options.onAuthException(e,t),function(){throw t}.defer())},onUnresponsiveHost:function(){var e;this.isTimeout||(this.cancelTimeout(),(e={status:0}).responseJSON={errorCode:WL.ErrorCode.UNRESPONSIVE_HOST,errorMsg:"unresponsive host"},"function"==typeof this.callerOptions.onFailure&&this.callerOptions.onFailure(e))},handleTimeout:function(){this.cancelTimeout(),this.isTimeout=!0;var e={};e.responseJSON={errorCode:WL.ErrorCode.REQUEST_TIMEOUT,errorMsg:WL.Utils.formatString("timeout",this.url)},"function"==typeof this.callerOptions.onFailure&&this.callerOptions.onFailure(e)},cancelTimeout:function(){null!==this.timeoutTimer&&(window.clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isTimeout=!1)},checkIfCanResend:function(){if(void 0===this.wlAnswers)return!0;for(var e in this.wlAnswers)if(Object.prototype.hasOwnProperty.call(this.wlAnswers,e)&&null===this.wlAnswers[e])return!1;return!0},setExpectedAnswers:function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this.wlAnswers[t]=null)},submitAnswer:function(e,t){this.wlAnswers[e]=t,this.checkIfCanResend()&&this.handleResendOrSendPostAnswers(e)},removeExpectedAnswer:function(e){delete this.wlAnswers[e],this.checkIfCanResend()&&this.handleResendOrSendPostAnswers(e)},handleResendOrSendPostAnswers:function(e){var t,n=this.createRequestHeaders(),r=!1,o=WLJSX.Object.toJSON(n).length,i=void 0===n.Authorization?-1:WLJSX.Object.toJSON(n.Authorization).length;(o>this.MAX_TOTAL_HEADER_SIZE||i>this.MAX_AUTH_HEADER_SIZE)&&-1<i&&(r=!0),r&&(this.postAnswerRealm=e,void 0!==(t=WL.Client.__chMap[e])&&t.moveToWaitingList(this)),this.sendRequest(n)}}),WLJSX.Ajax.WLRequest.options={method:"post",asynchronous:!0,encoding:"UTF-8",parameters:"",evalJSON:!0,timeout:6e4,onAuthentication:null,isAuthResponse:null},WL.AuthorizationManager=(Tm="client_id",Um="scope",Wm="challengeResponse",Xm="WWW-Authenticate",Ym="MFP-Conflict",_m="/az/v1/authorization/redirect",an="urn:ietf:params:oauth:client-assertion-type:jwt-bearer",bn="RegisteredClient",dn=!1,en="com.mfp.scope.token.mapping",fn="com.mfp.resource.scope.mapping",gn="com.mfp.oauth.application.data",hn="com.mfp.oauth.clientid",jn={session:!0},wn=[],yn=!1,En=[],Kn="8.0.0.0-IF201701250919",Mn=function(e,t){for(var n=0;n<3;n++)e[n]||e.push("0"),t[n]||t.push("0"),e[n]=On(e[n]),t[n]=On(t[n]);var r=e.slice(0,3).join(""),o=t.slice(0,3).join("");return r<o?1:o<r?-1:0},Nn=20,Qn=function(o,e){return{method:"POST",contentType:"application/x-www-form-urlencoded",parameters:e,onSuccess:function(e){WL.DAO.setItem(en,{},jn),o.resolve()},onFailure:function(e){ko(e)||WL.Logger.debug("Logout request failed with response: "+e.responseText),o.reject(new WL.Response(e))},onAuthRequestFailure:function(e){o.reject(e)},onAuthException:function(e,t){var n={status:500,responseJSON:{errorCode:WL.ErrorCode.API_INVOCATION_FAILURE,errorMsg:t.message}},r=new WL.Response(n,null);o.reject(r)},optionalHeaders:{}}},Sn=function(s,e){return{method:"POST",parameters:e,contentType:"application/x-www-form-urlencoded",onSuccess:function(e){var t,n,r,o=e.responseJSON,i=o.access_token;ko(i)?s.reject(new WL.Response(e)):(t=o.scope,n=o.expires_in,r=new WL.AccessToken(i,n,t),s.resolve(r))},onFailure:function(e){ko(e)||WL.Logger.debug("Token request failed with response: "+e.responseText),s.reject(new WL.Response(e))},onAuthRequestFailure:function(e){s.reject(e)},onAuthException:function(e,t){var n={status:500,responseJSON:{errorCode:WL.ErrorCode.API_INVOCATION_FAILURE,errorMsg:t.message}},r=new WL.Response(n,null);s.reject(r)}}},Tn=function(o){return{method:"POST",parameters:{},onSuccess:function(e){o.resolve(e)},onFailure:function(e){ko(e)||WL.Logger.debug("Authorization request failed with response: "+e.responseText),o.reject(new WL.Response(e))},onAuthRequestFailure:function(e){o.reject(e)},onAuthException:function(e,t){var n={status:500,responseJSON:{errorCode:WL.ErrorCode.API_INVOCATION_FAILURE,errorMsg:t.message}},r=new WL.Response(n,null);o.reject(r)},optionalHeaders:{}}},Un=function(){return WL.DAO.getItem(hn)},Vn=function(e){e||(WL.DAO.removeItem(hn),wlanalytics._setClientId("")),WL.DAO.setItem(hn,e),wlanalytics._setClientId(e)},Wn=function(){var n=WLJQ.Deferred();if(En.push(n),1<En.length)return n.promise();var r,o,e,i="registration/v1/self";return r=WLJQ.Deferred(),o={},e={device:WL.BrowserManager.getDeviceData(),application:WL.Config.__getApplicationData()},WL.CertManager.signJWS(e).then(function(e){var t;o.signedRegistrationData={header:(t=e.split("."))[0],payload:t[1],signature:t[2]},r.resolve(o)},function(e){r.reject(e)}),r.promise().then(function(e){var a,t=(a=n,{method:"POST",parameters:e,onSuccess:function(e){if(Ln(e)){200==e.status&&a.resolve(e);var t=e.getHeader("Location");if(ko(t))return void Fn(new WL.Response(e),!1);var n=t.split("/"),r=n[n.length-1];Vn(r),to(WL.BrowserManager.getDeviceData()),Fn(e,!0)}else{var o="This version of the MobileFirst client SDK requires a minimal server version greater than IFIX "+Kn,i={status:505,responseJSON:{errorCode:WL.ErrorCode.MINIMUM_SERVER,errorMsg:o}},s=new WL.Response(i,null);WL.Logger.error(o),Fn(s,!1)}},onFailure:function(e){var t,n=new WL.Response(e);ko(e)||(Ln(e)||e.responseJSON.errorCode==WL.ErrorCode.UNRESPONSIVE_HOST||(t={status:505,responseJSON:{errorCode:WL.ErrorCode.MINIMUM_SERVER,errorMsg:"This version of the MobileFirst client SDK requires a minimal server version greater than IFIX 8.0.0.0-IF201701250919"}},n=new WL.Response(t)),WL.Logger.debug("Authorization request failed with response: "+e.responseText)),Fn(n,!1)},onAuthRequestFailure:function(e){Fn(new WL.Response(e),!1)},onAuthException:function(e,t){var n={status:500,responseJSON:{errorCode:WL.ErrorCode.API_INVOCATION_FAILURE,errorMsg:t.message}};new WL.Response(n,null),Fn(e,!1)},optionalHeaders:{}});ko(Un())||(t.method="PUT",i=i+"/"+Un()),xo(i,t,!1)}),n.promise()},Xn=function(){var e=WLJQ.Deferred();return WL.DAO.removeItem(en,jn),WL.DAO.removeItem(fn,jn),WL.DAO.removeItem(WL.Client.getMessageID()),Vn(null),to(null),WL.CertManager.deleteKeyPair().then(function(){e.resolve()}),e.promise()},Yn=function(e){var t,n,o,r=WLJQ.Deferred(),i=(t=e,(n={response_type:"code"})[Tm]=Un(),n.scope=ko(t)?"":t,n.redirect_uri=Co(),n);return xo("az/v1/authorization",(o=r,{method:"GET",parameters:i,onSuccess:function(e){var t=e.responseJSON,n=t.code,r=t.error;ko(r)&&!ko(n)?o.resolve(n):o.reject(new WL.Response(e))},onFailure:function(e){ko(e)||WL.Logger.debug("Authorization request failed with response: "+e.responseText),o.reject(new WL.Response(e))},onAuthRequestFailure:function(e){o.reject(e)},onAuthException:function(e,t){var n={status:500,responseJSON:{errorCode:WL.ErrorCode.API_INVOCATION_FAILURE,errorMsg:t.message}},r=new WL.Response(n,null);o.reject(r)},optionalHeaders:{}}),!0),r.promise()},bo=function(e){return e?ao():WL.Config.__getBaseURL()},io=function(){var e,t=Un();ko(t)?WL.Logger.warn("Could not send heartbeat, heartbeat is sent only after client is registered"):(e=new WL.JWT,WL.CertManager.signJWS(e,{kid:Un()}).then(function(e){xo("preauth/v1/heartbeat",{method:"POST",contentType:"application/x-www-form-urlencoded",parameters:{client_assertion:e,client_assertion_type:an},onSuccess:function(e){WL.Logger.debug("Heartbeat sent successfully")},onFailure:function(e){WL.Logger.debug("Failed to send heartbeat. Response:  "+JSON.stringify(e))}},!1)},function(e){WL.Logger.debug("Failed to send heartbeat. Response:  "+JSON.stringify(e))}))},ko=function(e){return null==e},oo=function(e,t){lo(e,t.credentials,t.userCallbackDfd)},po=function(){return 1<wn.length||dn},qo=function(e,t,n,r){var o,i=!0;ko(o=e)||void 0===o.status||400!==o.status||ko(o.responseJSON)||"INVALID_CLIENT_ID"!==o.responseJSON.errorCode||yn||(i=!(yn=!0),WL.AuthorizationManager.__deleteAuthData().then(function(){Wn().then(function(){!function(e){for(var t=0;t<wn.length;t++)wn[t].clientId=e}(Un()),r.retryFunction(t,r)},function(e){Cn(e),Xn()})},function(e){Cn(e)})),i&&(Bn(0,t,e,dn=!1),ko(r.userCallbackDfd)||r.userCallbackDfd.reject(e))},{isAuthorizationRequired:function(e,t){if(ko(e)||ko(t))return!1;var n=WLJSX.String.parseResponseHeaders(t),r=WLJSX.String.getHeaderByKey(n,Ym);if(409===e&&!ko(r))return!0;var o=WLJSX.String.getHeaderByKey(n,Xm);return!(401!==e&&403!==e||ko(o)||ko(o[Xm]))&&0<=o[Xm].indexOf("Bearer")},obtainAccessToken:function(t){var e=WLJQ.Deferred();ko(t)&&(t=bn),t=ro(t);try{var n=tn(t);if(ko(n)){var r={clientId:null,scope:t,deferred:e};if(wn.push(r),po())return e.promise();wo()?Wn().then(function(){zn(t)},function(e){Xn(),Cn(e)}):zn(t)}else e.resolve(n)}catch(e){WL.Logger.error("failed obtaining token, reason: "+JSON.stringify(e)),Bn(0,t,JSON.stringify(e),!1)}return e.promise()},getResourceScope:function(e){if(ko(e))return null;var t=WLJSX.String.parseResponseHeaders(e),n=WLJSX.String.getHeaderByKey(t,Xm);return ko(n)?null:WL.AuthorizationManager.__getAuthorizationScope(n[Xm])},clearAccessToken:function(e){rn(e.scope,null)},setAuthorizationServerUrl:function(e){WL.Validators.validateURLOrNull(e,"setAuthorizationServerUrl"),WL.DAO.setItem("com.mfp.authorization.url",e)},getAuthorizationServerUrl:ao,login:function(e,t){var n,r=WLJQ.Deferred();return po()?(n=Eo(500,WL.ErrorCode.AUTHORIZATION_FAILURE,"Login already in process."),r.reject(n)):(ko(e)&&(e=bn),dn=!0,lo(e,t,r)),r.promise()},logout:function(t){var n=WLJQ.Deferred(),e=Un();return po()||ko(e)?n.reject(Eo(500,WL.ErrorCode.AUTHORIZATION_FAILURE,"Cannot logout while authorization request is in progress.")):(ko(t)&&(t=bn),dn=!0,vo(t).then(function(){Bn(0,t,null,!(dn=!1)),n.resolve()},function(e){Bn(0,t,null,dn=!1),n.reject(e)}),n.promise())},__invokeGetRegistrationData:function(){var t=WLJQ.Deferred(),n=Un();if(ko(n))return WL.Logger.warn("Could not get registration data, client is not registered"),t.reject();var e=new WL.JWT;return WL.CertManager.signJWS(e,{kid:n}).then(function(e){xo("registration/v1/self/"+n,{method:"GET",contentType:"application/x-www-form-urlencoded",parameters:{client_assertion:e,client_assertion_type:an},onSuccess:function(e){t.resolve(e)},onFailure:function(e){t.reject(e)}},!1)},function(e){WL.Logger.debug("Failed to send heartbeat. Response:  "+JSON.stringify(e))}),t.promise()},__invokeInstanceRegistration:Wn,__logAndThrowError:function(e,t){throw WL.Logger&&(t&&(e="Invalid invocation of method "+t+"; "+e),WL.Logger.error(e)),new Error(e)},__getAuthorizationScope:function(e){if(!ko(e))for(var t=e.split(","),n=0;n<t.length;n++){var r=t[n];if(0<=r.indexOf("scope="))return r.split("=")[1].replace(/\"/g,"")}return null},__getClientId:Un,__getCachedScopeByResource:function(e){var t=e.requestOptions.url,n=e.requestOptions.method;return mn(fn,t+"_"+n)},__deleteAuthData:Xn,__deleteCachedScopeByResource:function(e){var t=e.requestOptions.url,n=e.requestOptions.method;nn(fn,t+"_"+n)},__getWlServerUrl:bo,__getParameterByName:function(e,t){var n=e.split("?");if(n.length<2)return null;var r=[n[0]];n.splice(0,1),r.push(n.join("?"));for(var o=r[1].split("&"),i=0;i<o.length;i++){var s=o[i].split("=");if(s[0]===t)return decodeURIComponent(s[1].replace(/\+/g," "))}return null},__invokeAuthorizationRequestForScope:Yn,__cacheScopeByResource:function(e,t){var n=e.requestOptions.method,r=e.requestOptions.url+"_"+n,o=ro(t);ln(fn,r,o)},__getCachedAccessToken:tn,__isInvalidToken:function(e){return 0<=e.getResponseHeader(Xm).indexOf("invalid_token")},__sendHeartBeat:function(e){setInterval(io,e)},__sendLogoutRequest:vo,__serverRelativeTime:0,WL_AUTHORIZATION_HEADER:"Authorization",WWW_AUTHENTICATE_HEADER:Xm,DEFAULT_SCOPE:bn,MFP_CONFLICT_HEADER:Ym}),__WLDeviceAuth=function(){this.__requestToResend=null,this.__deviceChallengeToken=null,this.__defaultOnGetCustomDeviceProperties=function(e){e({})},this.__getDeviceDisplayName=function(n,t){WL.AuthorizationManager.__invokeGetRegistrationData().then(function(e){var t=e.responseJSON.registration.device.deviceDisplayName;n(t=t||null)},function(e){t(e)})},this.__setDeviceDisplayName=function(e,t,n){WL.AuthorizationManager.__getClientId()?(WL.BrowserManager.__setLocalDeviceDisplayName(e),WL.AuthorizationManager.__invokeInstanceRegistration().then(function(){WL.BrowserManager.__setLocalDeviceDisplayName(null),t(null)},function(e){WL.BrowserManager.__setLocalDeviceDisplayName(null),n(e)})):n("Can not set display name until device is registered")}},__WL.prototype.DeviceAuth=new __WLDeviceAuth,WL.DeviceAuth=new __WLDeviceAuth,WL.CookieManager=(Vt="JSESSIONID",Wt="WLSESSIONID",Xt="cookies",Yt=null,Zt=null,_t=null,bu=WLJSX.Class.create({init:function(){},storeCookies:function(){},readCookies:function(){},clearCookies:function(){}}),cu=WLJSX.Class.create(bu,{conn:null,init:function(){this.conn=new air.SQLConnection;var e=air.File.applicationStorageDirectory.resolvePath("worklight.db");try{this.conn.open(e)}catch(e){return void WL.Logger.error("Error opening cookies DB: "+e.message+", Details: "+e.details)}var t=new air.SQLStatement;t.sqlConnection=this.conn,t.text="CREATE TABLE IF NOT EXISTS cookies (name VARCHAR(255) PRIMARY KEY, value VARCHAR(255))";try{t.execute()}catch(e){WL.Logger.error("Error creating cookies DB tables: "+e.message+", Details: "+e.details)}},storeCookies:function(){try{var e,t,n=WLJSX.Object.toJSON(Yt);WL.Logger.debug("Storing cookies: "+n),null===this.getCookieValue(Xt)?((e=new air.SQLStatement).sqlConnection=this.conn,e.text='INSERT INTO cookies (name, value) VALUES("'+Xt+'", "'+n+'")',e.execute()):((t=new air.SQLStatement).sqlConnection=this.conn,t.text='UPDATE cookies SET name="'+Xt+'", value="'+n+'" WHERE name="'+Xt+'"',t.execute())}catch(e){WL.Logger.error("Error storing cookies: "+e.message+", Details: "+e.details)}},readCookies:function(){var e=this.getCookieValue(Xt);if(e){WL.Logger.debug("Read cookies: "+e);var t=WLJSX.String.evalJSON(e);for(var n in t)Yt[n]=t[n]}},clearCookies:function(){try{var e=new air.SQLStatement;e.sqlConnection=this.conn,e.text="DELETE FROM cookies",e.execute()}catch(e){WL.Logger.error("Error clearing cookies: "+e.message)}},getCookieValue:function(t){try{var e=null,n=new air.SQLStatement;n.sqlConnection=this.conn,n.text='SELECT * FROM cookies WHERE name="'+t+'"',n.execute();var r=n.getResult();if(null!==r.data)for(var o=r.data.length,i=0;i<o;i++)e=r.data[i].value;return e}catch(e){WL.Logger.error("Error getting cookie: "+t+", error: "+e.message)}}}),du=WLJSX.Class.create(bu,{storeCookies:function(){try{var e=WLJSX.Object.toJSON(Yt);WL.Logger.debug("Storing cookies: ("+e+")"),__WL.LocalStorage.setValue(Xt,e)}catch(e){WL.Logger.error("Error storing cookie: "+e.message)}},readCookies:function(){try{var e=__WL.LocalStorage.getValue(Xt);if(""===e)return;if(WL.Logger.debug("Read cookies: "+e),null!==e){var t=WLJSX.String.evalJSON(e);for(var n in t)Yt[n]=t[n]}}catch(e){WL.Logger.error("Error reading cookies: "+e.message)}},clearCookies:function(){try{var e=WLJSX.Object.toJSON(Yt);__WL.LocalStorage.clear(Xt),WL.Logger.debug("Delete cookies: "+e)}catch(e){WL.Logger.error("Error deleting cookies: "+e.message)}}}),eu=du,fu=du,ju=function(){return!1},{init:function(e,t,n){if(_t=t,Yt={},function(){switch(_t){case WL.Env.ADOBE_AIR:Zt=new cu;break;case WL.Env.IPHONE:case WL.Env.IPAD:Zt=new fu;break;case WL.Env.ANDROID:Zt=new eu;break;default:Zt=null}}(),null!==Zt){Zt.init();try{Zt.readCookies()}catch(e){WL.Logger.error("error read cookies: "+e.message),Zt.clearCookies()}WL.Logger.debug("CookieMgr read cookies: "+WLJSX.Object.toJSON(Yt))}},updateCookies:function(t){try{var e=WLJSX.String.evalJSON(t);for(var n in e)Yt[n]=e[n]}catch(e){WL.Logger.error("Problems to update cookies "+e+" "+t)}},clearCookies:function(){Yt={},null!==Zt&&Zt.clearCookies()},createCookieHeaders:function(){var e={};if(ju()){var t="";for(var n in Yt)t+=n+"="+Yt[n]+";";""!==t&&(e.Cookie=t)}var r=WL.BrowserManager.getDeviceData();return r.environment=WL.Client.getEnvironment(),e.deviceId=WLJSX.Object.toJSON(r),e},handleResponseHeaders:function(e){if(ju()){for(var t={},n=0;n<e.length;n++){var r=e[n];if(-1<r.toLowerCase().indexOf("set-cookie"))for(var o=function(e){for(var t=[],n=e.substr(e.indexOf(":")+1).split(","),r=0;r<n.length;r++){var o,i=n[r].split("=");i.length<2?WL.Logger.error("invalid cookie header: "+e):(o={name:WLJSX.String.strip(i[0]),value:WLJSX.String.strip(i[1].split(";")[0])},t.push(o))}return t}(r),i=0;i<o.length;i++){var s=o[i];s.name!=Vt&&s.name!=Wt?Yt[s.name]=s.value:t[s.name]=s.value,null!==Zt&&null!==Yt&&0<WLJSX.Object.objectSize(Yt)&&(delete Yt[Wt],delete Yt[Vt],Zt.storeCookies())}}if(ju())for(var a in t)Yt[a]=t[a]}},getJSessionID:function(){var e=iu(Vt);return null===e?null:e.value},areCookiesEnabled:function(){var e,t=!0;return WL.EnvProfile.isEnabled(WL.EPField.WEB)&&((e=new Date).setTime(e.getTime()+864e5),document.cookie="testcookie=oreo; expires="+e.toGMTString()+"; path=/",t="oreo"===iu("testcookie").value),t}}),WL.EnvProfile=(vv=null,{initialize:function(e){vv=void 0!==WL[e+"ProfileData"]?WL[e+"ProfileData"]:WL.DefaultProfileData},getValue:function(e){return vv[e]},isEnabled:function(e){return!!(e in vv&&vv[e])},disable:function(e){e in vv&&(vv[e]=!1)}}),__WL.MultiEventListener=WLJSX.Class.create({isEventComplete:!1,onEventsComplete:null,events:null,initialize:function(){this.events={}},__onEvent:function(e){for(var t in this.events[e.type]=!0,this.events)if(!this.events[t])return;this.onEventsComplete()},registerEvent:function(e){document.addEventListener(e,this.__onEvent.bind(this),!1),this.events[e]=!1}});var __WLEvents={WORKLIGHT_IS_CONNECTED:"WL:WORKLIGHT_IS_CONNECTED",WORKLIGHT_IS_DISCONNECTED:"WL:WORKLIGHT_IS_DISCONNECTED"};__WL.prototype.Events=__WLEvents,WL.Events=__WLEvents,__WLLocalStorage=function(){var n="undefined"!=typeof localStorage,r=". HTML5 localStorage not supported on current browser.";function e(){n="undefined"!=typeof localStorage,"undefined"!=typeof Storage&&n&&(Storage.prototype.clear=function(){for(var e in localStorage)"cookies"!==e&&"userName"!==e&&localStorage.removeItem(e)})}void 0!==document.addEventListener?document.addEventListener("deviceready",e,!1):document.attachEvent("ondeviceready",e),this.getValue=function(e){var t=null;return n?t=localStorage.getItem(e):WL.Logger.debug("Can't retrive value for key "+e+r),t},this.setValue=function(e,t){n?localStorage.setItem(e,t):WL.Logger.debug("Can't set value "+t+" for key"+e+r)},this.clear=function(e){n?localStorage.removeItem(e):WL.Logger.debug("Can't clear key "+e+r)},this.clearAll=function(){n?localStorage.clear():WL.Logger.debug("Can't clear storage "+r)}},__WL.LocalStorage=new __WLLocalStorage,__WLDevice=function(){this.getNetworkInfo=function(e){e({})}},__WL.prototype.Device=new __WLDevice,WL.Device=new __WLDevice,WL.ResourceRequest=function(e,t,n){function a(e,t){throw WL.Logger&&(t&&(e="Invalid invocation of method "+t+"; "+e),WL.Logger.error(e)),new Error(e)}var s={};function h(e){return null==e}var r,g,o=null==e?a("Request URL must be specified.","WLResourceRequest"):function(e){var t=e.split("?");if(1<t.length)for(var n=t[1].split("&"),r=0;r<n.length;r++){var o=n[r].split("="),i=s[o[0]];null==i&&(i=[],s[o[0]]=i),i[i.length]=o[1]}return t[0]}(e.trim()),v=void 0===t||(r=t)!==WL.ResourceRequest.GET&&r!==WL.ResourceRequest.POST&&r!==WL.ResourceRequest.PUT&&r!==WL.ResourceRequest.DELETE&&r!==WL.ResourceRequest.HEAD&&r!==WL.ResourceRequest.OPTIONS&&r!==WL.ResourceRequest.TRACE?a("Request method is invalid or not specified.","WLResourceRequest"):t,L={},m=this;m.scope=null;var S=7;function u(e){for(var t in L)if(t.toLowerCase()===e.toLowerCase())return{name:t,value:L[t]};return{name:null,value:null}}function W(e,t,n){var r=WLJQ.Deferred();return function(e,n,r,o){var i=WLJQ.Deferred(),t=window.WLJSX.Ajax.getTransport(),s=A(),a=null===s?e:e+"?"+s;t.requestOptions={url:a,method:v},t.open(v,a,!0),void 0!==g&&(t.timeout=g);(function(e){for(var t in L){var n=L[t];if(_(n))e.setRequestHeader(t,n.toString());else{for(var r=n[0],o=1;o<n.length;o++)r+=", "+n[o];e.setRequestHeader(t,r)}}})(t),t.onreadystatechange=function(){var e,t,n;4===this.readyState&&(0===(e=this).status&&(t="undefined"!==this.wlFailureStatus?this.wlFailureStatus:WL.ErrorCode.UNEXPECTED_ERROR,e.status=0,e.responseJSON={errorCode:t,errorMsg:this.statusText}),n=new WL.Response(this,null),0===this.status&&(n.status=0),void 0!==WL.AuthorizationManager&&u(e)&&(409!==e.status&&r<y||409===e.status&&o<S)?l(e):WL.Client.isGatewayResponse(n)?(WLAuthorizationManager.clearAccessToken({scope:m.scope?m.scope:""}),f(m.scope?m.scope:"")):200<=this.status&&this.status<=299?i.resolve(n):i.reject(n))};var u=function(e){return!h(e)&&WL.AuthorizationManager.isAuthorizationRequired(e.status,e.getAllResponseHeaders())},l=function(e){409===e.status?c(r,++o):403===e.status?(m.scope=WL.AuthorizationManager.getResourceScope(e.getAllResponseHeaders()),WL.Validators.isNullOrUndefined(m.scope)||(WL.AuthorizationManager.__cacheScopeByResource(e,m.scope),c(++r,o))):(WL.AuthorizationManager.__isInvalidToken(e)?WL.AuthorizationManager.clearAccessToken({scope:m.scope}):WL.AuthorizationManager.__cacheScopeByResource(e,WL.AuthorizationManager.DEFAULT_SCOPE),c(++r,o))},c=function(e,t){W(n,e,t).then(function(e){i.resolve(e)},function(e){i.reject(e)})};{var p;void 0!==WL.AuthorizationManager?WL.Validators.isNullOrUndefined(m.scope)?(p=WL.AuthorizationManager.__getCachedScopeByResource(t),f(m.scope=p)):f(m.scope):d()}function f(e){WL.Validators.isNullOrUndefined(e)?d():WL.AuthorizationManager.obtainAccessToken(e).then(function(e){WL.Validators.isNullOrUndefined(e)||(4==t.readyState&&t.open(t.requestOptions.method,t.requestOptions.url,!0),t.setRequestHeader(WL.AuthorizationManager.WL_AUTHORIZATION_HEADER,e.asAuthorizationRequestHeader)),d()},function(e){500===e.status&&(WL.AuthorizationManager.__deleteCachedScopeByResource(t),m.scope=null),i.reject(e)})}function d(){t.send("GET"===v?null:n,!0)}return i.promise()}(function(){{return 0<=o.indexOf("http:")||0<=o.indexOf("https:")?o:function(e){"/"!==e[e.length-1]&&"/"!==o[0]?e+="/":"/"===e[e.length-1]&&"/"===o[0]&&(e=e.substring(0,e.length-1));return e+o}(WL.Config.__getBaseURL())}}(),e,t,n).then(function(e){wlanalytics.send(!0),r.resolve(e)},function(e){r.reject(e)}),r.promise()}"number"==typeof n?g=n:(h(n)||h(n.timeout)||(g=n.timeout),h(n)||h(n.scope)||(m.scope=n.scope)),this.getUrl=function(){return o},this.getMethod=function(){return v},this.getQueryParameters=function(){var e={};for(var t in s){var n=s[t][0];e[t]=n}return e},this.getQueryString=A,this.setQueryParameters=function(e){if(s={},null!=e)for(var t in e)this.setQueryParameter(t,e[t])},this.setQueryParameter=function(e,t){null!=e&&null!=t&&(s[e]=[t])},this.getHeaders=function(e){if(null==e)return L;var t=L[e];return void 0===t&&(t=u(e).value),null!==t?WL.Validators.isArray(t)?t:[t]:void 0},this.getHeaderNames=function(){var e=[];for(var t in L)e.push(t);return e},this.getHeader=function(e){null==e&&a("Header name should be defined.","WLResourceRequest.getHeader");var t=L[e];return void 0===t&&(t=u(e).value),WL.Validators.isArray(t)?t[0]:t},this.setHeaders=function(e){if(null!=e){for(var t in e){var n=e[t];WL.Validators.isArray(n)?0<n.length&&!function(e){for(var t=0;t<e.length;t++)if(!_(e[t]))return!1;return!0}(n)&&a("Header value should be a simple type.","WLResourceRequest.setHeaders"):_(n)||a("Header value should be a simple type.","WLResourceRequest.setHeaders")}for(var r in L={},e){var o=e[r];if(WL.Validators.isArray(o))for(var i in o)this.addHeader(r,o[i]);else this.addHeader(r,o)}}else L={}},this.setHeader=function(e,t){for(var n in _(t)||a("Header value should be a simple type.","WLResourceRequest.setHeader"),L)n.toLowerCase()===e.toLowerCase()&&delete L[n];L[e]=t},this.addHeader=function(e,t){null==t&&a("Header value should not be null or undefined.","WLResourceRequest.addHeader"),_(t)||a("Header value should be a simple type.","WLResourceRequest.addHeader");var n=u(e),r=n.name,o=n.value;if(null===o)L[e]=t;else if(WL.Validators.isArray(o)){for(var i in o)if(o[i].toString()===t.toString())return;o.push(t)}else{var s=[];s.push(o),s.push(t),L[r]=s}},this.getTimeout=function(){return g},this.setTimeout=function(e){g=e},this.send=function(e){var t="";return null!=e&&(t=_(e)?e.toString():JSON.stringify(e)),W(t,0,0)},this.sendFormParameters=function(e){var t=function(e){if(null==e)return"";var t="";{if(_(e)){for(var n=e.split("&"),r=0;r<n.length;r++){var o=n[r].split("=");0!==o.length&&(1===o.length?t+=encodeURIComponent(o[0]):t+=encodeURIComponent(o[0])+"="+encodeURIComponent(o[1]),r<n.length-1&&(t+="&"))}return t}for(var i in e){var s=e[i];_(s)||a("Form value must be a simple type.","WLResourceRequest.sendFormParameters"),t+=encodeURIComponent(i)+"="+encodeURIComponent(s),t+="&"}return 0<t.length&&"&"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t}}(e);return this.addHeader("Content-Type","application/x-www-form-urlencoded"),W(t,0,0)};var y=4;function A(){if(null==s||WLJQ.isEmptyObject(s))return null;var e="";for(var t in s){var n=s[t];if(null==n||0===n.length)e+="&"+t;else for(var r=0;r<n.length;r++){var o=_(n[r])?n[r]:JSON.stringify(n[r]);e+=null==o?"&"+t:"&"+t+"="+encodeURIComponent(o)}}return e.substr(1)}function _(e){return WL.Validators.isString(e)||WL.Validators.isNumber(e)||WL.Validators.isBoolean(e)}},WL.ResourceRequest.GET="GET",WL.ResourceRequest.POST="POST",WL.ResourceRequest.PUT="PUT",WL.ResourceRequest.DELETE="DELETE",WL.ResourceRequest.HEAD="HEAD",WL.ResourceRequest.OPTIONS="OPTIONS",WL.ResourceRequest.TRACE="TRACE",WL.ResourceRequest.CONNECT="CONNECT";var clockSyncChallengeHandler=WL.Client.createSecurityCheckChallengeHandler("clockSynchronization");clockSyncChallengeHandler.handleSuccess=function(e){var t=new Date;WL.Config.__setServerRelativeTime(e.serverTimeStamp-t.getTime())};var wl_remoteDisableChallengeHandler=WL.Client.createSecurityCheckChallengeHandler("wl_remoteDisableRealm");function isDisplayMessageDialogue(e,t,n){return"NOTIFY"!=n||(void 0===e||e!=t)}function getEnv(){return WL.StaticAppProps.ENVIRONMENT}wl_remoteDisableChallengeHandler.handleChallenge=function(e){var t,n=e.message,r=e.messageId,o=e.messageType,i=WL.DAO.getItem(WL.Client.getMessageID()),s={messageId:r};isDisplayMessageDialogue(i,r,o)?(addRemoteDisableHTML(),setDirectionToRemoteDisableMsg(),document.getElementById("remoteDisableHeaderId").innerHTML=WL.ClientMessages.notificationTitle,document.getElementById("remoteDisableTextId").innerHTML=n,(t=document.getElementById("remoteDisableModalId")).style.display="block",document.getElementById("remoteDisableCloseBtnId").onclick=function(){t.style.display="none",wl_remoteDisableChallengeHandler.submitChallengeAnswer(s)},WL.DAO.setItem(WL.Client.getMessageID(),r)):wl_remoteDisableChallengeHandler.submitChallengeAnswer(s)},wl_remoteDisableChallengeHandler.handleFailure=function(e){var t;void 0===e||null==e?(t="unknown error occurred.",WL.Logger.debug(">>> wl_remoteDisableChallengeHandler.handleFailure invoked with a missing err argument")):t=e.message?e.message:e.reason?e.reason:(WL.Logger.debug(">>> wl_remoteDisableChallengeHandler.handleFailure invoked with unexpected err format: "+JSON.stringify(e,null,4)),"unknown error occurred.");var n=e.downloadLink;WL.Client.__handleOnRemoteDisableDenial(function(e,t,n){addRemoteDisableHTML(),setDirectionToRemoteDisableMsg(),document.getElementById("remoteDisableHeaderId").innerHTML=WL.ClientMessages.applicationDenied,document.getElementById("remoteDisableTextId").innerHTML=t;var r=document.getElementById("remoteDisableRedirectBtnId");n?(r.style.display="block",r.onclick=function(){WL.App.__openURL(n,"_new",null)}):r.style.display="none";var o=document.getElementById("remoteDisableModalId");o.style.display="block",document.getElementById("remoteDisableCloseBtnId").onclick=function(){o.style.display="none"}},this,t,n)};var addRemoteDisableHTML=(Cy=!1,function(){var e,t;Cy||(Cy=!0,(e=document.createElement("div")).className="remoteDisableModalClass",e.id="remoteDisableModalId",e.innerHTML='<div class="remoteDisableHeaderContent"><h2 id="remoteDisableHeaderId" class="remoteDisableHeader"></h2><div><p id=remoteDisableTextId class="remoteDisableText"></p></div><div class=removeDisableButtons><button id="remoteDisableCloseBtnId" class="closeBtn">'+WL.ClientMessages.close+'</button><button id="remoteDisableRedirectBtnId" class="remoteDisableRedirectBtn">'+(WL.ClientMessages.redirect?WL.ClientMessages.redirect:"Redirect")+"</button></div></div>",(t=document.createElement("style")).innerHTML='.remoteDisableModalClass {display: none; /* Hidden by default */position: fixed; /* Stay in place */z-index: 1; /* Sit on top */padding-top: 100px; /* Location of the box */left: 0;top: 0;width: 100%; /* Full width */height: 100%; /* Full height */overflow: auto; /* Enable scroll if needed */background-color: rgb(0,0,0); /* Fallback color */background-color: rgba(0,0,0,0.4); /* Black w/ opacity */}.remoteDisableHeaderContent {background-color: #fefefe;margin: auto;padding: 20px;border: 1px solid #888;width: 70%;min-width: 40%;}.remoteDisableHeader {margin: 0 0 5px 0;}.remoteDisableText {margin: 0;word-wrap: break-word;}.removeDisableButtons {margin: 15px 0 33px 0;font-family: sans-serif}.closeBtn {float: right;font-size: 15px;}.remoteDisableModalClass[dir="rtl"] .closeBtn {float: left;}.remoteDisableRedirectBtn {display: none;float: left;font-size: 15px;}.remoteDisableRedirectBtn:hover {background-color: #555555;color: white;cursor: pointer;}.closeBtn:hover {background-color: #555555;color: white;cursor: pointer;}',document.getElementsByTagName("head")[0].appendChild(t),document.body.appendChild(e))}),Cy,setDirectionToRemoteDisableMsg=function(){WL.Utils.getLanguageDirectionality(WL.ClientMessages.lang)===WL.Language.DIRECTION_RTL&&(document.getElementById("remoteDisableModalId").dir="rtl")},hE,iE,nE,oE,pE;function kE(r){var o=WLJQ.Deferred(),e=WL.Validators.isNullOrUndefined(r)?hE:r;return iE.hasOwnProperty(r)&&!WL.Validators.isNullOrUndefined(iE[r])?o.resolve(iE[r]):oE(e).then(function(e){var t,n;WL.Validators.isNullOrUndefined(e)?(t=r,n=WLJQ.Deferred(),t=WL.Validators.isNullOrUndefined(t)?hE:t,WL.Crypto.generateKeyPair().then(function(e){iE[t]=e,nE(t,e).then(function(){n.resolve(e)},function(e){WL.Logger.error("Failed to save keypair in indexDB "+JSON.stringify(e)),n.reject(e)})},function(e){n.reject(e)}),n.promise().then(function(e){o.resolve(e)},function(e){o.reject(e)})):o.resolve(e)},function(e){o.reject(e)}),o.promise()}return isCryptoShim=!1,function(e){"use strict";var t,n,p=!1;!/(iPhone|iPod|iPad)/i.test(navigator.userAgent)||null!=(t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/))&&(n=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||0,10)],p=parseFloat(n.join(".")));var f,r,o,d,h,u,l,i,g=e.crypto||e.msCrypto;function v(e){return btoa(e).replace(/\=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function L(e){return e=(e+="===").slice(0,-e.length%4),atob(e.replace(/-/g,"+").replace(/_/g,"/"))}function m(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function S(e){return e instanceof ArrayBuffer&&(e=new Uint8Array(e)),String.fromCharCode.apply(String,e)}function W(e){var t={name:(e.name||e||"").toUpperCase().replace("V","v")};switch(t.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":e.length&&(t.length=e.length);break;case"HMAC":e.hash&&(t.hash=W(e.hash)),e.length&&(t.length=e.length);break;case"RSAES-PKCS1-v1_5":e.publicExponent&&(t.publicExponent=new Uint8Array(e.publicExponent)),e.modulusLength&&(t.modulusLength=e.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":e.hash&&(t.hash=W(e.hash)),e.publicExponent&&(t.publicExponent=new Uint8Array(e.publicExponent)),e.modulusLength&&(t.modulusLength=e.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return t}function y(e){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[e.name][(e.hash||{}).name||e.length||""]}function A(t){(t instanceof ArrayBuffer||t instanceof Uint8Array)&&(t=JSON.parse(decodeURIComponent(escape(S(t)))));var n={kty:t.kty,alg:t.alg,ext:t.ext||t.extractable};switch(n.kty){case"oct":n.k=t.k;case"RSA":["n","e","d","p","q","dp","dq","qi","oth"].forEach(function(e){e in t&&(n[e]=t[e])});break;default:throw new TypeError("Unsupported key type")}return n}function _(e,t){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(t=t||{pos:0,end:e.length}).end-t.pos<2||t.end>e.length)throw new RangeError("Malformed DER");var n,r=e[t.pos++],o=e[t.pos++];if(128<=o){if(o&=127,t.end-t.pos<o)throw new RangeError("Malformed DER");for(var i=0;o--;)i<<=8,i|=e[t.pos++];o=i}if(t.end-t.pos<o)throw new RangeError("Malformed DER");switch(r){case 2:n=e.subarray(t.pos,t.pos+=o);break;case 3:if(e[t.pos++])throw new Error("Unsupported bit string");o--;case 4:n=new Uint8Array(e.subarray(t.pos,t.pos+=o)).buffer;break;case 5:n=null;break;case 6:var s=btoa(S(e.subarray(t.pos,t.pos+=o)));if(!(s in u))throw new Error("Unsupported OBJECT ID "+s);n=u[s];break;case 48:n=[];for(var a=t.pos+o;t.pos<a;)n.push(_(e,t));break;default:throw new Error("Unsupported DER tag 0x"+r.toString(16))}return n}function c(e,t){var n=0,r=0,o=(t=t||[]).length+2;if(t.push(0,0),e instanceof Uint8Array){n=2,r=e.length;for(var i=0;i<r;i++)t.push(e[i])}else if(e instanceof ArrayBuffer){n=4,r=e.byteLength,e=new Uint8Array(e);for(i=0;i<r;i++)t.push(e[i])}else if(null===e)n=5,r=0;else if("string"==typeof e&&e in l){var s=m(atob(l[e])),n=6;r=s.length;for(i=0;i<r;i++)t.push(s[i])}else if(e instanceof Array){for(i=0;i<e.length;i++)c(e[i],t);n=48,r=t.length-o}else{if(!("object"==typeof e&&3===e.tag&&e.value instanceof ArrayBuffer))throw new Error("Unsupported DER value "+e);n=3,r=(e=new Uint8Array(e.value)).byteLength,t.push(0);for(i=0;i<r;i++)t.push(e[i]);r++}if(128<=r){var a=r,r=4;for(t.splice(o,0,a>>24&255,a>>16&255,a>>8&255,255&a);1<r&&!(a>>24);)a<<=8,r--;r<4&&t.splice(o,4-r),r|=128}return t.splice(o-2,2,n,r),t}function O(e,t,n,r){Object.defineProperties(this,{_key:{value:e},type:{value:e.type,enumerable:!0},extractable:{value:void 0===n?e.extractable:n,enumerable:!0},algorithm:{value:void 0===t?e.algorithm:t,enumerable:!0},usages:{value:void 0===r?e.usages:r,enumerable:!0}})}function w(e){return"verify"===e||"encrypt"===e||"wrapKey"===e}function b(e){return"sign"===e||"decrypt"===e||"unwrapKey"===e}!g||(f=g.subtle||g.webkitSubtle)&&(r=e.Crypto||g.constructor||Object,o=e.SubtleCrypto||f.constructor||Object,e.CryptoKey||e.Key||Object,h=11<=p||-1<navigator.userAgent.indexOf("Version/11.")&&-1<navigator.userAgent.indexOf("Safari")?(d=!!e.msCrypto,!!g.subtle):(d=!!e.msCrypto,!!g.webkitSubtle),(d||h)&&(isCryptoShim=!0,u={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},l={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"},["generateKey","importKey","unwrapKey"].forEach(function(l){var c=f[l];f[l]=function(t,e,n){var r,o,i,s,a,u=[].slice.call(arguments);switch(l){case"generateKey":r=W(t),o=e,i=n;break;case"importKey":r=W(n),o=u[3],i=u[4],"jwk"===t&&((e=A(e)).alg||(e.alg=y(r)),e.key_ops||(e.key_ops="oct"!==e.kty?"d"in e?i.filter(b):i.filter(w):i.slice()),u[1]=(s=A(e),d&&(s.extractable=s.ext,delete s.ext),11<=p||-1<navigator.userAgent.indexOf("Version/11.")&&-1<navigator.userAgent.indexOf("Safari")?s:m(unescape(encodeURIComponent(JSON.stringify(s)))).buffer));break;case"unwrapKey":r=u[4],o=u[5],i=u[6],u[2]=n._key}if("generateKey"===l&&"HMAC"===r.name&&r.hash)return r.length=r.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[r.hash.name],f.importKey("raw",g.getRandomValues(new Uint8Array(r.length+7>>3)),r,o,i);if(h&&"generateKey"===l&&"RSASSA-PKCS1-v1_5"===r.name&&(!r.modulusLength||2048<=r.modulusLength))return(t=W(t)).name="RSAES-PKCS1-v1_5",delete t.hash,f.generateKey(t,!0,["encrypt","decrypt"]).then(function(e){return Promise.all([f.exportKey("jwk",e.publicKey),f.exportKey("jwk",e.privateKey)])}).then(function(e){return e[0].alg=e[1].alg=y(r),e[0].key_ops=i.filter(w),e[1].key_ops=i.filter(b),Promise.all([f.importKey("jwk",e[0],r,o,e[0].key_ops),f.importKey("jwk",e[1],r,o,e[1].key_ops)])}).then(function(e){return{publicKey:e[0],privateKey:e[1]}});if((h||d&&"SHA-1"===(r.hash||{}).name)&&"importKey"===l&&"jwk"===t&&"HMAC"===r.name&&"oct"===e.kty)return f.importKey("raw",m(L(e.k)),n,u[3],u[4]);if(h&&"importKey"===l&&("spki"===t||"pkcs8"===t))return f.importKey("jwk",function(e){var t=_(e),n=!1;2<t.length&&(n=!0,t.shift());var r={ext:!0};switch(t[0][0]){case"1.2.840.113549.1.1.1":var o=["n","e","d","p","q","dp","dq","qi"],i=_(t[1]);n&&i.shift();for(var s=0;s<i.length;s++)i[s][0]||(i[s]=i[s].subarray(1)),r[o[s]]=v(S(i[s]));r.kty="RSA";break;default:throw new TypeError("Unsupported key type")}return r}(e),n,u[3],u[4]);if(d&&"unwrapKey"===l)return f.decrypt(u[3],n,e).then(function(e){return f.importKey(t,e,u[4],u[5],u[6])});try{a=c.apply(f,u)}catch(e){return Promise.reject(e)}return d&&(a=new Promise(function(t,n){a.onabort=a.onerror=function(e){n(e)},a.oncomplete=function(e){t(e.target.result)}})),a=a.then(function(e){return"HMAC"===r.name&&(r.length||(r.length=8*e.algorithm.length)),0==r.name.search("RSA")&&(r.modulusLength||(r.modulusLength=(e.publicKey||e).algorithm.modulusLength),r.publicExponent||(r.publicExponent=(e.publicKey||e).algorithm.publicExponent)),e=e.publicKey&&e.privateKey?{publicKey:new O(e.publicKey,r,o,i.filter(w)),privateKey:new O(e.privateKey,r,o,i.filter(b))}:new O(e,r,o,i)})}}),["exportKey","wrapKey"].forEach(function(i){var s=f[i];f[i]=function(t,n,r){var e,o=[].slice.call(arguments);switch(i){case"exportKey":o[1]=n._key;break;case"wrapKey":o[1]=n._key,o[2]=r._key}if((h||d&&"SHA-1"===(n.algorithm.hash||{}).name)&&"exportKey"===i&&"jwk"===t&&"HMAC"===n.algorithm.name&&(o[0]="raw"),!h||"exportKey"!==i||"spki"!==t&&"pkcs8"!==t||(o[0]="jwk"),d&&"wrapKey"===i)return f.exportKey(t,n).then(function(e){return"jwk"===t&&(e=m(unescape(encodeURIComponent(JSON.stringify(A(e)))))),f.encrypt(o[3],r,e)});try{e=s.apply(f,o)}catch(e){return Promise.reject(e)}return d&&(e=new Promise(function(t,n){e.onabort=e.onerror=function(e){n(e)},e.oncomplete=function(e){t(e.target.result)}})),"exportKey"===i&&"jwk"===t&&(e=e.then(function(e){return(h||d&&"SHA-1"===(n.algorithm.hash||{}).name)&&"HMAC"===n.algorithm.name?{kty:"oct",alg:y(n.algorithm),key_ops:n.usages.slice(),ext:!0,k:v(S(e))}:((e=A(e)).alg||(e.alg=y(n.algorithm)),e.key_ops||(e.key_ops="public"===n.type?n.usages.filter(w):"private"===n.type?n.usages.filter(b):n.usages.slice()),e)})),!h||"exportKey"!==i||"spki"!==t&&"pkcs8"!==t||(e=e.then(function(e){return e=function(e){var t,n=[["",null]],r=!1;switch(e.kty){case"RSA":for(var o=["n","e","d","p","q","dp","dq","qi"],i=[],s=0;s<o.length&&o[s]in e;s++){var a=i[s]=m(L(e[o[s]]));128&a[0]&&(i[s]=new Uint8Array(a.length+1),i[s].set(a,1))}2<i.length&&(r=!0,i.unshift(new Uint8Array([0]))),n[0][0]="1.2.840.113549.1.1.1",t=i;break;default:throw new TypeError("Unsupported key type")}return n.push(new Uint8Array(c(t)).buffer),r?n.unshift(new Uint8Array([0])):n[1]={tag:3,value:n[1]},new Uint8Array(c(n)).buffer}(A(e))})),e}}),["encrypt","decrypt","sign","verify"].forEach(function(u){var l=f[u];f[u]=function(e,t,n,r){if(d&&(!n.byteLength||r&&!r.byteLength))throw new Error("Empy input is not allowed");var o,i,s=[].slice.call(arguments),a=W(e);d&&"decrypt"===u&&"AES-GCM"===a.name&&(o=e.tagLength>>3,s[2]=(n.buffer||n).slice(0,n.byteLength-o),e.tag=(n.buffer||n).slice(n.byteLength-o)),s[1]=t._key;try{i=l.apply(f,s)}catch(e){return Promise.reject(e)}return d&&(i=new Promise(function(r,t){i.onabort=i.onerror=function(e){t(e)},i.oncomplete=function(e){var t,n,e=e.target.result;"encrypt"===u&&e instanceof AesGcmEncryptResult&&(t=e.ciphertext,n=e.tag,(e=new Uint8Array(t.byteLength+n.byteLength)).set(new Uint8Array(t),0),e.set(new Uint8Array(n),t.byteLength),e=e.buffer),r(e)}})),i}}),d&&(i=f.digest,f.digest=function(e,t){if(!t.byteLength)throw new Error("Empy input is not allowed");var r;try{r=i.call(f,e,t)}catch(e){return Promise.reject(e)}return r=new Promise(function(t,n){r.onabort=r.onerror=function(e){n(e)},r.oncomplete=function(e){t(e.target.result)}})},e.crypto=Object.create(g,{getRandomValues:{value:function(e){return g.getRandomValues(e)}},subtle:{value:f}}),e.CryptoKey=O),h&&(11<=p||-1<navigator.userAgent.indexOf("Version/11.")&&-1<navigator.userAgent.indexOf("Safari")||(g.subtle=f),e.Crypto=r,e.SubtleCrypto=o,e.CryptoKey=O)))}(this),__WLCrypto=function(){var e=WLJQ.Deferred();try{var r=window.crypto.subtle||window.crypto.webkitSubtle}catch(e){WL.Logger.info("No Crypto Object in this browser! "+JSON.stringify(e))}function t(){var t=WLJQ.Deferred(),e={name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},n=!WL.AsyncDAO.isIndexedDB()||isCryptoShim;return r.generateKey(e,n,["sign"]).then(function(e){t.resolve(e)},function(e){WL.Logger.error("Failed to generate keypair "+JSON.stringify(e)),t.reject(e)}),t.promise()}function n(s,a,u){var l=WLJQ.Deferred();return p(u).then(function(e){var t=e.alg;e.kid=WL.Validators.isNullOrUndefined(a)?void 0:a;var n={alg:t,jwk:e},r=JSON.stringify(n),o=JSON.stringify(s),i=d(r)+"."+d(o);c(i,u).then(function(e){l.resolve(i+"."+e)},function(e){l.reject(e)})},function(e){l.reject(e)}),l.promise()}function o(e,t,n){var r=WLJQ.Deferred(),o={alg:"HS256",jwk:f(t),key:n.publicKey},i=JSON.stringify(o),s=JSON.stringify(e),a=d(i)+"."+d(s),u=new jsSHA("SHA-256","TEXT");u.setHMACKey(n.publicKey,"TEXT"),u.update(a);var l=u.getHMAC("B64");return r.resolve(a+"."+l),r.promise()}function i(){var t=WLJQ.Deferred();try{t.resolve(s(7))}catch(e){var n=function(){sjcl.random.removeEventListener("seeded",n),sjcl.random.stopCollectors(),t.resolve(s(4))};sjcl.random.addEventListener("seeded",n),sjcl.random.startCollectors()}return t.promise()}var c=function(e,t){var n=WLJQ.Deferred();return r.sign({name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},t.privateKey,new Uint8Array(u(e))).then(function(e){var t=btoa(String.fromCharCode.apply(null,new Uint8Array(e)));n.resolve(t)}).catch(function(e){WL.Logger.error("error in signing data with keypair: "+e.toString()),n.reject(e)}),n.promise()},p=function(e){var t=WLJQ.Deferred();return r.exportKey("jwk",e.publicKey).then(function(e){t.resolve(e)},function(e){WL.Logger.error("Failed to extract public key from keypair "+e.toString()),t.reject(e)}),t.promise()};function s(e){for(var t=sjcl.random.randomWords(4,e),n="",r=0;r<t.length;r++)n+=btoa(t[r]);n=(n=n.replace(/=/g,"")).substring(0,32);var o={};return o.privateKey=n,o.publicKey=n,o}var a,f=function(e){var t={};return t.kid=WL.Validators.isNullOrUndefined(e)?void 0:e,t.use="enc",t.kty="oct",t.k="",t},d=function(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(u(e))))},u=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t};return a=WLJQ.Deferred(),(window.crypto&&window.crypto.subtle||window.msCrypto&&window.msCrypto.subtle||window.crypto&&window.crypto.webkitSubtle)&&t().done(function(){a.resolve(!0)}).fail(function(){a.resolve(!1)}),a.resolve(!1),a.promise().always(function(e){WL.Crypto=e?{signJWS:n,generateKeyPair:t}:{signJWS:o,generateKeyPair:i}}),e.promise()},__WLIndexDB=function(){var t,r,o="default",i=null;function s(e){return WL.Validators.validateDefined(r,"getObjectStore"),r.transaction(o,e).objectStore(o)}this.init=function(){var n=WLJQ.Deferred();i=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,WL.Validators.validateDefined(i,"init"),t=WL.Config.__getApplicationName();var e=i.open(t,1);return e.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(o)||t.createObjectStore(o,{keyPath:"key"}),e.target.transaction.oncomplete=function(){r=e.target.result,n.resolve()}},e.onerror=function(e){WL.Logger.error(JSON.stringify(e.target.error.message)),n.reject(e.target.error)},e.onsuccess=function(e){r=e.target.result,n.resolve()},n.promise()},this.setItem=function(e,t){var n=WLJQ.Deferred(),r={key:e,value:t},o=s("readwrite").put(r);return o.onsuccess=function(){n.resolve()},o.onerror=function(e){WL.Logger.error("Error setting item in indexedDb : "+e.target.error.name),n.reject(e)},n.promise()},this.getItem=function(e){var t=WLJQ.Deferred(),n=s("readonly").get(e);return n.onerror=function(e){WL.Logger.error("Error getting item from indexedDb : "+e.target.error.name),t.reject(e)},n.onsuccess=function(){WL.Validators.isNullOrUndefined(n.result)?t.resolve():t.resolve(n.result.value)},t.promise()},this.removeItem=function(e){var t=WLJQ.Deferred();return s("readwrite").delete(e).onsuccess=function(){t.resolve()},t.promise()},this.clearDB=function(){var n=WLJQ.Deferred();return window.indexedDB.open(t,1).onsuccess=function(e){var t=e.target.result.transaction(o,"readwrite").objectStore(o).clear();t.onsuccess=function(e){n.resolve()},t.onerror=function(e){n.reject()}},n.promise()}},__WLDAO=function(){var r;this.init=function(){try{if((r=new __WLLocalStorageDB).init(),r.setItem("testKey","testValue"),"testValue"!=r.getItem("testKey"))throw"LocalStorage Error";r.removeItem("testKey")}catch(e){(r=new __WLVarStorageDB).init()}},this.setItem=function(e,t,n){r.setItem(e,t,n)},this.getItem=function(e,t){return r.getItem(e,t)},this.removeItem=function(e,t){r.removeItem(e,t)}},__WL.prototype.DAO=new __WLDAO,WL.DAO=new __WLDAO,__WLAsyncDAO=function(){var r,n=!1;this.init=function(){var t=WLJQ.Deferred();r=new __WLIndexDB;try{r.init().done(function(){r.setItem("testKey","testValue").done(function(){r.getItem("testKey").done(function(e){"testValue"==e?r.removeItem("testKey").done(function(){n=!0,t.resolve()}):((r=new __WLSyncDAOWrapper).init(),t.resolve())})})}).fail(function(){(r=new __WLSyncDAOWrapper).init(),t.resolve()})}catch(e){(r=new __WLSyncDAOWrapper).init(),t.resolve()}return t.promise()},this.setItem=function(e,t){var n=WLJQ.Deferred();return r.setItem(e,t).then(function(){n.resolve()}),n.promise()},this.getItem=function(e){var t=WLJQ.Deferred();return r.getItem(e).then(function(e){t.resolve(e)}),t.promise()},this.removeItem=function(e){var t=WLJQ.Deferred();return r.removeItem(e).then(function(){t.resolve()}),t.promise()},this.isIndexedDB=function(){return n}},__WLSyncDAOWrapper=function(){var r;this.init=function(){var e=WLJQ.Deferred();return(r=new __WLDAO).init(),e.resolve(),e.promise()},this.setItem=function(e,t){var n=WLJQ.Deferred();return r.setItem(e,t),n.resolve(),n.promise()},this.getItem=function(e){var t=WLJQ.Deferred(),n=r.getItem(e);return t.resolve(n),t.promise()},this.removeItem=function(e){var t=WLJQ.Deferred();return r.removeItem(e),t.resolve(),t.promise()}},__WLVarStorageDB=function(){var t,o={};function i(e){return t+"."+e}this.init=function(){t=WL.Config.__getApplicationName()},this.setItem=function(e,t){var n=i(e),r=t?JSON.stringify(t):null;o[n]=r},this.getItem=function(e){var t=i(e);return value=o[t],value?JSON.parse(value):null},this.removeItem=function(e){var t=i(e);delete o[t]}},WL.CertManager=(hE="com.mfp.oauth.keypair",iE={},nE=function(e,t){var n=WLJQ.Deferred(),r=e+".private.key",o=e+".public.key",i=t.privateKey,s=t.publicKey;return WL.AsyncDAO.setItem(o,s).then(function(){WL.AsyncDAO.setItem(r,i).then(function(){n.resolve()},function(e){n.reject(e)})},function(e){n.reject(e)}),n.promise()},oE=function(e){var t=WLJQ.Deferred(),n=e+".private.key",r=e+".public.key",o={};return WL.AsyncDAO.getItem(n).then(function(e){e||t.resolve(null),o.privateKey=e,WL.AsyncDAO.getItem(r).then(function(e){e||t.resolve(null),o.publicKey=e,t.resolve(o)},function(e){t.reject(e)})},function(e){t.reject(e)}),t.promise()},pE=function(e){var t=WLJQ.Deferred(),n=e+".private.key",r=e+".public.key";return WL.AsyncDAO.removeItem(n).always(function(){WL.AsyncDAO.removeItem(r).always(function(){t.resolve()})}),t.promise()},{init:function(){var t=WLJQ.Deferred();return __WL.prototype.AsyncDAO=new __WLAsyncDAO,WL.AsyncDAO=new __WLAsyncDAO,WL.AsyncDAO.init().done(function(){new __WLCrypto,t.resolve()},function(e){t.reject(e)}),t.promise()},signJWS:function(t,e){var n=WL.Validators.isNullOrUndefined(e)?{}:e,r=WLJQ.Deferred(),o=n.kid,i=WL.Validators.isNullOrUndefined(n.keyPairId)?hE:i;return kE(i).then(function(e){WL.Crypto.signJWS(t,o,e).then(function(e){r.resolve(e)},function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise()},deleteKeyPair:function(e){var t=WLJQ.Deferred(),n=WL.Validators.isNullOrUndefined(e)?hE:e;return iE.hasOwnProperty(n)&&(iE.keyPairId=null),pE(n).then(function(){t.resolve()},function(e){t.reject(e)}),t.promise()},getOrCreateKeyPair:kE}),window.WLResourceRequest=WL.ResourceRequest,window.WLAuthorizationManager=WL.AuthorizationManager,WL.Logger=wlanalytics.logger,WL});